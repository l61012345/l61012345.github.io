---
title: 05. 定时器
category_bar: true
date: 2021/10/22
categories: 
- 学习笔记
- 电子系统
---
# 定时器
## 电容器的充放电特性
在RC电路中，当电容与电压源连通时电容会进行充电，而断开连接后电容器会放电，充电和放电的过程电容器的电压和电流都随着时间的变化而变化。设时间常数$τ=RC$，分析电容器充放电过程的特性。  

### 电容器的充电特性
充电时电容器上的电压会随着时间增大：  
$$V=V_0(1-e^{-\frac{t}{τ}})$$
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022194059.png width=50%>  

经过$1τ$，电容器电压达到最大值的62%，经过$5τ$时可以认为电容器已经充满电。  
电流随着时间逐渐变为0:  
$$I=I_0e^{-\frac{t}{τ}}$$
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022193952.png width=50%>  

同样地，经过$1τ$，电容器电流流失到原来的37%，经过$5τ$时可以认为没有电流通过电容器。  

### 电容器的放电特性
放电时，电容器的电压变化与充电时相反，随着时间的推移，电压逐渐流失：  
$$V=V_0e^{-\frac{t}{τ}}$$
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022194713.png width=50%>  

经过$1τ$，电容器电流流失到原来的37%，经过$5τ$时可以认为没有电流通过电容器。  
同时，电流也随着时间逐渐流失，与充电过程不同的是，电流流失的方向是相反的：  
$$I=-I_0e^{-\frac{t}{τ}}$$
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022194804.png width=50%>  

与电压流失相同，经过$1τ$，电容器电流流失到原来的37%，经过$5τ$时可以认为没有电流通过电容器。  

### 三角波发生器
利用电容器的充放电性质，可以让输入电压周期性地打开和关闭与电容的连接，电容器会不断地进行充放电，形成三角波形。事实上“周期性地打开和关闭”的效果与输入信号为方波时相同。  
理想条件下，可以由此设计三角波发生器，其电路完全等同于低通滤波器。  
需要注意的是，考虑到电容器的完全充放电是需要时间的，输入信号的频率应该比较低，以给予电容器合适的充放电时间。  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022195421.png width=50%>  

将上述的电路进一步改进，得到如下的电路：  
该电路由两部分组成：  

1. 由直流电压源、电阻和电容组成的三角波发生器电路，该电路在电容和电压源附近各有一个开关，如图所示：  
   <img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022200001.png width=50%>  

   - 当$S_1$闭合、$S_2$打开时，电压源会向电容器充电。  
   - 当$S_1$打开、$S_2$闭合时，电容器会放电到$R_2$。  
   因此该电路通过控制$S_1$、$S_2$的开闭来控制电容器的充放电。  
2. $S_1$、$S_2$开关连接至RS触发器电路，RS触发器的R端和S端分别连接两个比较器，如图所示：  
   <img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022200338.png width=50%>  
   
   - 当输入电压$V_{in}>V_1$时，上方的比较器向触发器的S端发送高电平，而下方比较器由于$V_2>V_{in}$则不会向R端发送高电平，此时RS触发器的输入逻辑：$S=1,R=0$，根据RS触发器的真值表可以得到$Q=1,\overline{Q}=0$，$S_1$闭合、$S_2$打开时，电压源会向电容器充电。  
   - 当输入电压$V_{in}<V_1$时，下方的比较器向触发器的R端发送高电平，而上方比较器由于$V_{in}<V_1$则不会向S端发送高电平，此时RS触发器的输入逻辑：$S=0,R=1$，根据RS触发器的真值表可以得到$Q=0,\overline{Q}=1$，$S_1$打开、$S_2$闭合，使电容器放电。  

> RS 触发器真值表：  
> <img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022205217.png width=50%>  

当输入$V_{in}$是一个正弦波或者方波时，与$V_1$、$V_2$的大小关系会被自动触发，从而形成稳定而连续的三角波波形，其波形如下图所示：  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022201022.png width=50%>  

## 555定时器
555定时器是一种利用电容器充放电性质的电路元件，它可以通过直流电压输出稳定的方波。其元件内部结构如图所示：  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022201421.png width=80%>  

其中的NPN晶体管作用类似于开关。上方三个$5kΩ$的分压器将输入电压$V_{cc}$分割成$\frac{2}{3}V_{cc}$和$\frac{1}{3}V_{cc}$并分别送入比较器2、1。其中比较器2将$\frac{2}{3}V_{cc}$与外接电压Threshold进行比较，比较器1将$\frac{1}{3}V_{cc}$与外接电压Trigger进行比较，以控制SR触发器的输入。  
同时，555定时器还支持使用ControlVoltage替代$\frac{2}{3}V_{cc}$作为比较电压。SR触发器的输出为Ouput和Reset。  
555定时器有三种工作状态（电路连接方式）：非稳态、单稳态和多稳态，这三种连接分别可以产生三种不同的方波波形。  

### 非稳态模式
非稳态模式(Astable)下555定时器的连接图如下图所示：  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022210029.png width=80%>

如图，VCC分别作为内部和外部电路的电压源，外部电路是一个基本的RC电路。而外部电路的输出端与Threshold和Trigger连接，从而起到自我触发的效果。  
开始时电容器充电，当$Threshold>\frac{2}{3}V_{cc}$时，SR触发器输入逻辑为：$R=1,S=0$，输出为低电平，同时由于$\overline{Q}=1$，NPN晶体管被导通，电容器开始放电。  
当$Threshold<\frac{2}{3}V_{cc}$时，SR触发器输入逻辑为：$R=0,S=1$，输出为高电平，同时由于$\overline{Q}=0$，NPN晶体管关断，电容器充电。  
此后，由于Threshold/Trigger电压的变化，电容器会不断地进行充放电，从而在输出端产生稳定的高低电平方波，而电容器处产生稳定的锯齿波三角波，且周期占空比与输出的方波信号完全相同:  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022210401.png width=50%>  

可以发现锯齿波/三角波的上下限为$\frac{2}{3}V_{CC}$和$\frac{1}{3}V_{CC}$。  

在电路连接时往往还会增加另一个电容$C_2$以提高电路的稳定性。  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211104164835.png width=50%>  

#### 有关计算
在电容器充电过程，电流实际上流过了外部的两个电阻$R_1、R_2$，因此充电过程的时间常数：$τ_1=(R_1+R_2)C_1$。  
放电过程中电流只流过了$R_2$,因此放电过程的时间常数：$τ_2=R_2C_1$。  
根据数学推导得到充电时间：   
$$t_{char}=ln2(R_1+R_2)C_1$$
放电时间：  
$$t_{Discr}=ln2R_2C_1$$
周期：  
$$T=t_{char}+t_{Discr}=ln2(R_1+2R_2)C_1$$
振荡频率：  
$$f_r=\frac{1}{T}=\frac{1.44}{(R_1+2R_2)C_1}$$
定义输出波形一周期内的高电平出现时间占整个周期时间的比例为占空比，有：  
$$Duty Cyecle=\frac{R_1+R_2}{R_1+2R_2}× 100\%$$
**因此，非稳态的555定时器输出的方波可以通过改变$R_1$和$R_2$的值改变占空比。**  
可以发现这种基本的非稳态555振荡器配置的问题在于占空比，因为电阻$R_2$的存在使得占空比永远大于50%。  
换句话说，该电路不能使输出“ON”时间短于“OFF”时间，因为$(R_1 + R_2)C$ 总是大于$R_1C$的值。  

{% note info %}
当$R_2$远大于$R_1$时，$Duty Cyecle=50\%$。  
{% endnote %}

**$V_{Control}$对输出波形的影响**：  
充放电时间中的参数$ln2$实际上是由$\frac{1}{3}V_{CC}$和$\frac{2}{3}V_{CC}$进行决定的：  
$$Const=ln\frac{V_{CC}-0.5V_{Control}}{V_{CC}-V_{Control}}$$
当$V_{CC}=15V,V_{Control}=\frac{2}{3}V_{CC}$时，$Const=ln2$。  
如果Pin5：Control-Voltage接入直流电压，则$V_{Control}≠\frac{2}{3}V_{CC}$。  
此时产生的三角波的上下限应该为：$\frac{1}{3}V_{CC}-V_{Control}$。  
输出的方波周期发生变化，高电平和低电平的持续时间同比例增加或者减小，占空比仍然保持不变。  

#### 50%占空比555稳定器*
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211104165149.png width=50%>   

555振荡器现在产生50％的占空比作为定时电容， $C_1$ 现在通过相同的电阻器充电和放电， $R_2$ 而不是如前所述通过定时器放电引脚7放电。当555振荡器的输出为高电平时，电容器通过 $R_2$ 充电，当输出为低电平时，它通过 $R_2$ 放电。电阻器 $R_1$ 用于确保电容器完全充电至与电源电压相同的值。

### 单稳态模式*
单稳态模式由于振荡电容器$C_1$直接接地，因此电容器在充电后直接放电至接地，所以在单稳态模式下，555定时器的输出只会产生一个方波信号，其电路图如下所示：  
<img src = https://cdn.jsdelivr.net/gh/l61012345/Pic/img/20211022211852.png width=80%>  
方波信号的持续时间：  
$$τ=1.1R_1C_1$$