{"version":3,"sources":["main-js/src/hook.ts","core-lib/src/global.ts","core-lib/src/param-base.ts","core-lib/src/key-manager.ts","core-lib/src/manifest.ts","core-lib/src/url-conf.ts","core-lib/src/url-loader.ts","core-lib/src/file-conf.ts","core-lib/src/file-loader.ts","core-lib/src/updater.ts","core-lib/src/freecdn.ts","core-lib/src/promisex.ts","main-js/src/sw.ts","core-lib/src/param-mods/br.ts","core-lib/src/param-mods/bundle.ts","core-lib/src/param-mods/charset.ts","core-lib/src/param-mods/data.ts","core-lib/src/param-mods/expires.ts","core-lib/src/param-mods/hash.ts","core-lib/src/param-mods/headers.ts","core-lib/src/param-mods/open-timeout.ts","core-lib/src/param-mods/pos.ts","core-lib/src/param-mods/prefix.ts","core-lib/src/param-mods/recv-timeout.ts","core-lib/src/param-mods/referrer-policy.ts","core-lib/src/param-mods/req-headers.ts","core-lib/src/param-mods/size.ts","core-lib/src/param-mods/stream.ts","core-lib/src/param-mods/suffix.ts","core-lib/src/param-mods/valid-status.ts","core-lib/src/param-mods/xor.ts","core-lib/src/param-mods/mime/mime-data.ts","core-lib/src/param-mods/mime/mime.ts","core-lib/src/cache-manager.ts","core-lib/src/database.ts","core-lib/src/network.ts","core-lib/src/util.ts","core-lib/src/zone-host.ts"],"names":[],"mappings":"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","file":"freecdn-main.js","sourcesContent":["/**\n * JS Hook Util\n * example: https://codepen.io/etherdream/pen/WNoQQbG?editors=0012\n */\nnamespace Hook {\n  /**\n   * hook function\n   */\n  export function func<\n    T, K extends keyof T,\n\n    // T[K] must be a function\n    F = T[K] extends (...args: infer P) => infer R\n      ? (this: T, ...args: P) => R\n      : never\n  >(\n    obj: T,\n    key: K,\n    factory: (oldFn: F) => F\n  ) {\n    const oldFn: F = obj[key] as any\n    if (!oldFn) {\n      return false\n    }\n    const newFn = factory(oldFn)\n    obj[key] = newFn as any\n    return true\n  }\n\n  /**\n   * hook property\n   */\n  export function prop<\n    T, K extends keyof T,\n\n    GETTER extends (this: T) => T[K],\n    SETTER extends (this: T, value: T[K]) => void,\n\n    GETTER_FACTORY extends (oldGetter: GETTER) => GETTER,\n    SETTER_FACTORY extends (oldSetter: SETTER) => SETTER,\n  >(\n    obj: T,\n    key: K,\n    getterFactory: GETTER_FACTORY | null,\n    setterFactory: SETTER_FACTORY | null,\n  ) {\n    const desc = Object.getOwnPropertyDescriptor(obj, key)\n    if (!desc) {\n      return false\n    }\n    if (getterFactory) {\n      func(desc, 'get', getterFactory)\n    }\n    if (setterFactory) {\n      func(desc, 'set', setterFactory)\n    }\n    Object.defineProperty(obj, key, desc)\n    return true\n  }\n}\n","declare const VER: string\ndeclare const RELEASE: never\nconst IS_DEBUG = typeof RELEASE === 'undefined'\n\n\nconst DEFAULT_PARAMS = `\n@__default__\n expires=30s\n mime=auto\n open_timeout=10s\n valid_status=200\n`\nconst DEFAULT_MANIFEST_PATH = '/freecdn-manifest.txt'\nconst MY_URL = location.href\nconst MY_HOST = location.host\nconst MY_ORIGIN = location.origin\nconst ROOT_PATH = MY_ORIGIN + '/'\n\nconst INTERNAL_DIR = 'freecdn-internal/' + (IS_DEBUG ? 'dev' : VER)\nconst INTERNAL_PATH = new URL(INTERNAL_DIR, ROOT_PATH).pathname\nconst REG_IMG_EXTS = /\\.(?:jpg|jpeg|png|apng|gif|ico|bmp)$/i\n\nconst enum LEN {\n  SHA256_BIN = 32,\n  SHA256_B64 = 44,\n  PUBKEY_B64 = 124,\n}\n\ntype params_t = ReadonlyMap<string, string>\n\nconst NATIVE_FETCH = fetch\nconst EMPTY_BUF = new Uint8Array(0)\n\nconst CRYPTO = crypto.subtle\n\n\nlet gInited: boolean | PromiseX\n\nasync function globalInit() {\n  if (gInited) {\n    return gInited\n  }\n  gInited = promisex()\n\n  await CacheManager.init()\n  await Network.init()\n  UrlConf.init()\n\n  gInited.resolve()\n  gInited = true\n}","interface RequestArgs extends RequestInit {\n  headers: Headers\n}\n\ninterface ResponseArgs extends ResponseInit {\n  headers: Headers\n  status: number\n  statusText: string\n}\n\nclass ParamError extends Error {\n  public constructor(message: string) {\n    super(message)\n  }\n}\n\nabstract class ParamBase {\n  public onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) : may_async<Response | void> {\n  }\n\n  public onResponse(resArgs: ResponseArgs, fileLoader: FileLoader, rawRes: Response) : void {\n  }\n\n  public onData(chunk: Uint8Array) : may_async<Uint8Array> {\n    return chunk\n  }\n\n  public onEnd(chunk: Uint8Array) : may_async<Uint8Array> {\n    return chunk\n  }\n\n  public onError(error: any) : void {\n  }\n\n  public onAbort(reason: any) : void {\n  }\n}\n\ninterface ParamSub {\n  new(...args: any[]) : ParamBase\n\n  reuse?: boolean\n\n  parseConf(conf: string) :\n    any[] |     // construct args\n    string |    // error info\n    undefined   // off\n\n  priority?: number\n}","namespace KeyManager {\n  let mKey: CryptoKey\n\n\n  export async function set(keyBase64: string) {\n    const keyBin = base64Decode(keyBase64)\n    if (!keyBin) {\n      return\n    }\n    mKey = await CRYPTO.importKey('spki', keyBin, {\n      name: 'ECDSA',\n      namedCurve: 'P-256',\n    }, false, ['verify'])\n  }\n\n  export async function verify(data: Uint8Array) {\n    if (!mKey) {\n      return false\n    }\n    const linePos = data.lastIndexOf(10)  // 10 = '\\n'\n    const lineBin = data.subarray(linePos + 1)\n    const lineTxt = bytesToUtf8(lineBin)\n\n    const m = lineTxt.match(/# SIGN: ([A-Za-z0-9+/=]{88})$/)\n    if (!m) {\n      return false\n    }\n    const signTxt = m[1]\n    const signBin = base64Decode(signTxt) as Uint8Array\n    const dataBin = data.subarray(0, linePos)\n\n    return await CRYPTO.verify({\n      name: 'ECDSA',\n      hash: {\n        name: 'SHA-256'\n      },\n    }, mKey, signBin, dataBin)\n  }\n}","//\n// 匹配清单中的文件块。例如：\n//\n// (http://foo/path/to/file)\n//    ...\n// (/path/to/file)\n//    ...\n// (@config)\n//    ...\n// 其中 $0 为文件名，内容部分只匹配不捕获，之后通过 lastIndex 截取\n//\nconst REG_HEAD_LINE = /^(?:\\/|https?:|@).*/mg\n\n\nclass Manifest {\n  private readonly urlFileMap = new Map<string, FileConf>()\n  public globalParams!: params_t\n\n\n  public has(key: string) {\n    return this.urlFileMap.has(key)\n  }\n\n  public get(key: string) {\n    return this.urlFileMap.get(key)\n  }\n\n  public getParams(name: string) {\n    const fileConf = this.get(name)\n    if (fileConf) {\n      fileConf.parse()\n      return fileConf.params\n    }\n  }\n\n  public async parse(txt: string) {\n    this.parseFile(txt + DEFAULT_PARAMS)\n\n    const inc = this.urlFileMap.get('@include')\n    if (inc) {\n      const cdn = new FreeCDN()\n      cdn.manifest = this\n\n      const urls = inc.getLines()\n      const rets = urls.map(cdn.fetchText, cdn)\n      const txts = await Promise.all(rets)\n      txts.forEach(this.parseFile, this)\n    }\n  }\n\n  private parseFile(txt: string) {\n    // lazy parse\n    let name = ''\n    let last = 0\n\n    for (;;) {\n      const m = REG_HEAD_LINE.exec(txt)\n      if (last > 0) {\n        if (name[0] !== '@') {\n          name = toRelUrl(name)\n        }\n        const curr = m ? m.index : txt.length\n        const part = txt.substring(last, curr)\n        const conf = new FileConf(name, part)\n\n        this.urlFileMap.set(name, conf)\n      }\n      if (!m) {\n        break\n      }\n      name = m[0]\n      last = REG_HEAD_LINE.lastIndex\n    }\n\n    const m0 = this.getParams('@__default__') as params_t\n    const m1 = this.getParams('@global')\n\n    this.globalParams = m1 ? new Map([...m0, ...m1]) : m0\n  }\n}\n","class UrlConf {\n  private static nameClassMap: {[name: string] : ParamSub}\n\n  public static init() {\n    // 为了让代码更简洁，这里没有逐一引用各个参数对应的文件\n    // 如果该列表定义在全局，会出现依赖顺序的问题\n    this.nameClassMap = {\n      // 参数优先级（越前面的参数优先执行）\n      'data': ParamData,\n      'bundle': ParamBundle,\n\n      'open_timeout': ParamOpenTimeout,\n      'recv_timeout': ParamRecvTimeout,\n      'referrer_policy': ParamReferrerPolicy,\n      'req_headers': ParamReqHeaders,\n      'valid_status': ParamValidStatus,\n\n      'headers': ParamHeaders,\n      'expires': ParamExpires,\n      'mime': ParamMime,\n      'charset': ParamCharset,\n\n      'pos': ParamPos,\n      'size': ParamSize,\n      'xor': ParamXor,\n      'br': ParamBr,\n\n      'prefix': ParamPrefix,\n      'suffix': ParamSuffix,\n      'hash': ParamHash,\n      'stream': ParamStream,\n    }\n    Object.values(this.nameClassMap).forEach((cls, i) => {\n      cls.priority = i\n    })\n  }\n\n  // 不带片段部分的 URL（可以是相对路径）\n  public readonly url: string\n\n  // URL 片段部分\n  public readonly frag: string | undefined\n\n\n  public constructor(\n    fullUrl: string,\n    private readonly fileParams: params_t\n  ) {\n    [this.url, this.frag] = getPair(toRelUrl(fullUrl), '#')\n  }\n\n  public parse(manifest: Manifest) {\n    // TODO: cache result\n    const params = new Map<string, string>()\n\n    // 参数优先级: 全局参数 < 站点参数 < 文件参数 < URL 参数\n    mergeMap(params, manifest.globalParams)\n\n    // 站点参数\n    const host = this.url[0] === '/' ? MY_HOST : getHostFromUrl(this.url)\n    const hostParams = manifest.getParams('@host ' + host)\n    if (hostParams) {\n      mergeMap(params, hostParams)\n    }\n\n    // 文件参数\n    mergeMap(params, this.fileParams)\n\n    // URL 参数（定义在 # 后面）\n    if (this.frag) {\n      const urlParams = new URLSearchParams(this.frag)\n      mergeMap(params, urlParams)\n    }\n\n    const mods: ParamBase[] = []\n\n    for (const [k, v] of params) {\n      const cls = UrlConf.nameClassMap[k]\n      if (!cls) {\n        console.warn('[FreeCDN/UrlConf] unknown param:', k)\n        continue\n      }\n      const ret = cls.parseConf(v)\n      if (ret === undefined) {\n        continue\n      }\n      if (typeof ret === 'string') {\n        console.warn('[FreeCDN/UrlConf] parseConf failed. mod:', k, 'err:', ret, 'conf:', v)\n        continue\n      }\n      const obj = new cls(...ret)\n      mods.push(obj)\n    }\n\n    mods.sort((a, b) =>\n      ((a.constructor as ParamSub).priority as number) -\n      ((b.constructor as ParamSub).priority as number)\n    )\n    return mods\n  }\n}\n","class UrlLoader {\n  private readonly abortCtrl = new AbortController()\n\n  private pauseSignal: PromiseX | undefined\n  private isNetErr = false\n  private isDone = false\n  private isAborted = false\n\n  public bytesRead = 0\n  public onResponse!: (args: ResponseArgs) => void\n  public onData!: (chunk: Uint8Array) => void\n  public onEnd!: () => void\n  public onError!: (err: Error) => void\n\n\n  public constructor(\n    public readonly url: string,\n    private readonly paramMods: ParamBase[]) {\n  }\n\n  public async request(fileLoader: FileLoader) {\n    let err: any\n    try {\n      err = await this.requestUnsafe(fileLoader)\n    } catch (e) {\n      console.assert(e instanceof ParamError, e)\n      err = e\n    }\n\n    if (err && !this.isAborted) {\n      for (const mod of this.paramMods) {\n        mod.onError(err)\n      }\n      this.onError(err)\n\n      // TODO: network.addError(err)\n\n      if (!this.isNetErr) {\n        this.abort(err)\n      }\n    }\n  }\n\n  private async requestUnsafe(fileLoader: FileLoader) {\n    const {rawReq} = fileLoader\n    const {method} = rawReq\n    const reqArgs: RequestArgs = {\n      method,\n      referrer: rawReq.referrer,\n      referrerPolicy: 'same-origin',\n      headers: new Headers(),\n    }\n\n    if (method === 'POST' || method === 'PUT') {\n      reqArgs.body = await rawReq.clone().arrayBuffer()\n    }\n\n    let res: Response | void\n\n    for (const mod of this.paramMods) {\n      // 可直接返回响应（例如 data 参数、bundle 参数）\n      const ret = mod.onRequest(reqArgs, fileLoader)\n      if (ret) {\n        // await is slow\n        // https://gist.github.com/EtherDream/52649e4939008e149d0cb3a944c055b7\n        res = isPromise(ret) ? await ret : ret\n        if (res) {\n          break\n        }\n      }\n    }\n\n    if (!res) {\n      reqArgs.signal = this.abortCtrl.signal\n\n      const req = new Request(this.url, reqArgs)\n      try {\n        res = await Network.fetch(req)\n      } catch (err) {\n        this.isNetErr = true\n        return err\n      }\n    }\n\n    const resArgs: ResponseArgs = {\n      status: res.status,\n      statusText: res.statusText,\n      headers: new Headers(),\n    }\n    for (const mod of this.paramMods) {\n      mod.onResponse(resArgs, fileLoader, res)\n    }\n    this.onResponse(resArgs)\n\n    if (!res.body) {\n      return new Error('cors error')\n    }\n    const reader = res.body.getReader()\n    let buf: Uint8Array\n\n    READ: for (;;) {\n      try {\n        const {value} = await reader.read()\n        if (!value) {\n          break\n        }\n        buf = value\n      } catch (err) {\n        this.isNetErr = true\n        return err\n      }\n\n      for (const mod of this.paramMods) {\n        const ret = mod.onData(buf)\n        buf = isPromise(ret) ? await ret : ret\n        if (buf.length === 0) {\n          continue READ\n        }\n      }\n\n      if (buf.length > 0) {\n        this.pauseSignal && await this.pauseSignal\n        this.bytesRead += buf.length\n        this.onData(buf)\n      }\n    } // READ NEXT\n\n    this.isDone = true\n    buf = EMPTY_BUF\n\n    for (const mod of this.paramMods) {\n      const ret = mod.onEnd(buf)\n      buf = isPromise(ret) ? await ret : ret\n    }\n\n    if (buf.length > 0) {\n      this.pauseSignal && await this.pauseSignal\n      this.bytesRead += buf.length\n      this.onData(buf)\n    }\n\n    this.onEnd()\n  }\n\n  public pause() {\n    console.assert(!this.pauseSignal)\n    this.pauseSignal = promisex()\n  }\n\n  public resume() {\n    this.pauseSignal?.resolve()\n    this.pauseSignal = undefined\n  }\n\n  public abort(reason: any) {\n    if (this.isDone) {\n      return\n    }\n    this.isAborted = true\n    this.abortCtrl.abort()\n\n    for (const mod of this.paramMods) {\n      mod.onAbort(reason)\n    }\n  }\n}\n","// 匹配缩进开头的行，捕获 trim 后的内容（排除 `#` 注释行）\nconst REG_SUB_LINE = /^\\s+([^#\\s].+?)\\s*$/mg\n\n\nclass FileConf {\n  public urlConfs!: readonly UrlConf[]\n  public params!: params_t\n\n\n  public constructor(\n    public readonly name: string,\n    private text: string\n  ) {\n  }\n\n  public getLines() {\n    const lines: string[] = []\n    for (;;) {\n      const m = REG_SUB_LINE.exec(this.text)\n      if (!m) {\n        break\n      }\n      lines.push(m[1])\n    }\n    this.text = ''\n    return lines\n  }\n\n  public parse() {\n    if (this.text === '') {\n      return\n    }\n    const urlConfs: UrlConf[] = []\n    const params = new Map<string, string>()\n\n    for (const line of this.getLines()) {\n      if (/^https?:|^\\//.test(line)) {\n        const urlConf = new UrlConf(line, params)\n        urlConfs.push(urlConf)\n      } else {\n        const [key, val] = getPair(line, '=')\n        if (val === undefined) {\n          console.warn('[FreeCDN/FileConf] missing param value:', line)\n          continue\n        }\n        params.set(key, val)\n      }\n    }\n    this.params = params\n    this.urlConfs = urlConfs\n  }\n}\n","const FILE_BACKUP_PARAMS = [\n  'open_timeout',\n  'recv_timeout',\n  'hash',\n  'req_headers',\n  'valid_status',\n]\n\nclass FileLoaderError extends Error {\n  public constructor(message: string) {\n    super(message)\n  }\n  public urlErrs!: {url: string, err: Error}[]\n}\n\n\nclass FileLoader {\n  private readonly urlConfs: UrlConf[]\n  private readonly urlLoaderSet = new Set<UrlLoader>()\n\n  private delayTid = 0\n  private urlErrs: {url: string, err: Error}[] = []\n\n  private readonly hasRange: boolean = false\n  private readonly rangeBegin!: number\n  private readonly rangeEnd!: number\n  private readonly fileSize!: number\n\n  private opened = false\n  private closed = false\n  private bytesRead = 0\n\n  public onOpen!: (args: ResponseArgs) => void\n  public onData!: (chunk: Uint8Array) => void\n  public onEnd!: () => void\n  public onError!: (err: FileLoaderError) => void\n\n\n  public constructor(\n    public readonly fileConf: FileConf,\n    public readonly rawReq: Request,\n    public readonly manifest: Manifest,\n    public readonly weightConf: Map<string, number>,\n    public range: string | null,\n    public suffix: string\n  ) {\n    if (range) {\n      const r = this.parseReqRange(range)\n      if (r) {\n        [this.rangeBegin, this.rangeEnd] = r\n        this.hasRange = true\n        this.bytesRead = this.rangeBegin\n      }\n\n      const fileSize = fileConf.params.get('size')\n      if (fileSize) {\n        this.fileSize = +fileSize\n      }\n    }\n\n    // 原始 URL 作为后备资源\n    let backupParams: params_t\n\n    if (fileConf.params.has('data') || fileConf.params.has('bundle')) {\n      // 使用内嵌数据时，可保留所有参数\n      backupParams = fileConf.params\n    } else {\n      // 使用原始 URL 时禁止修改内容，例如 pos、xor 等操作\n      // 因此只保留白名单中的参数\n      const map = new Map<string, string>()\n      for (const k of FILE_BACKUP_PARAMS) {\n        const v = fileConf.params.get(k)\n        if (v !== undefined) {\n          map.set(k, v)\n        }\n      }\n      backupParams = map\n    }\n    const backupUrlConf = new UrlConf(fileConf.name, backupParams)\n\n    this.urlConfs = fileConf.urlConfs.concat(backupUrlConf)\n  }\n\n  private parseReqRange(range: string) {\n    // 目前只考虑 `bytes=begin-end` 和 `bytes=begin-` 格式\n    const m = range.match(/bytes=(\\d+)-(\\d*)/i)\n    if (!m) {\n      return\n    }\n    const begin = +m[1]\n    const end = +m[2]   // +'' === 0\n\n    if (end !== 0 && end <= begin) {\n      return\n    }\n    return [begin, end]\n  }\n\n  private buildResRange(resArgs: ResponseArgs) {\n    let end = 0\n    if (this.rangeEnd !== 0) {\n      end = this.rangeEnd - 1\n    } else if (this.fileSize) {\n      end = this.fileSize - 1\n    }\n    const val = 'bytes ' + this.rangeBegin + '-' + end + '/' + (this.fileSize || '*')\n\n    // TODO: status 416\n    resArgs.status = 206\n    resArgs.headers.set('content-range', val)\n  }\n\n  public open() {\n    this.loadNextUrl()\n  }\n\n  public pause() {\n    for (const urlLoader of this.urlLoaderSet) {\n      urlLoader.pause()\n    }\n  }\n\n  public resume() {\n    for (const urlLoader of this.urlLoaderSet) {\n      urlLoader.resume()\n    }\n  }\n\n  public abort(reason: any) {\n    for (const urlLoader of this.urlLoaderSet) {\n      urlLoader.abort(reason)\n    }\n    if (this.delayTid !== 0) {\n      clearTimeout(this.delayTid)\n    }\n  }\n\n  private getNextUrl() {\n    const {urlConfs} = this\n    const lastIndex = urlConfs.length - 1\n    if (lastIndex === -1) {\n      return\n    }\n    const now = getTimeSec()\n    let weight = -10000\n    let index = 0\n\n    urlConfs.forEach((conf, i) => {\n      const w = Network.getUrlWeight(conf.url, now, this.weightConf)\n      if (w > weight) {\n        weight = w\n        index = i\n      }\n    })\n\n    // 删除 urlConfs[index]\n    const conf = urlConfs[index]\n    urlConfs[index] = urlConfs[lastIndex]\n    urlConfs.length = lastIndex\n\n    return {weight, conf}\n  }\n\n  public loadNextUrl(delay = 0) {\n    const ret = this.getNextUrl()\n    if (!ret) {\n      if (this.urlLoaderSet.size === 0) {\n        const err = new FileLoaderError('failed to load: ' + this.getFileConfUrl())\n        err.urlErrs = this.urlErrs\n        this.onError(err)\n      }\n      return\n    }\n    const {weight, conf} = ret\n\n    if (weight < 0 && delay > 0) {\n      // 并行加载多个备用 URL 时，推迟低权重的站点（例如当前站点、收费站点）\n      this.delayTid = setTimeout(() => {\n        this.delayTid = 0\n        this.createUrlLoader(conf)\n      }, delay)\n      return\n    }\n    this.createUrlLoader(conf)\n  }\n\n  public getFileConfUrl() {\n    return this.fileConf.name + this.suffix\n  }\n\n  private getBackupUrl(url: string) {\n    if (url.endsWith('/')) {\n      return url + this.suffix\n    }\n    return url\n  }\n\n  private createUrlLoader(urlConf: UrlConf) {\n    const url = this.getBackupUrl(urlConf.url)\n    const mods = urlConf.parse(this.manifest)\n\n    const urlLoader = new UrlLoader(url, mods)\n    this.urlLoaderSet.add(urlLoader)\n\n    urlLoader.onData = (chunk) => {\n      if (this.closed) {\n        return\n      }\n      const add = urlLoader.bytesRead - this.bytesRead\n      if (add <= 0) {\n        // 当前节点的进度落后于总进度，丢弃收到的数据\n        return\n      }\n      if (add !== chunk.length) {\n        chunk = chunk.subarray(-add)\n      }\n      this.bytesRead = urlLoader.bytesRead\n\n      if (this.rangeEnd) {\n        const exceed = this.bytesRead - this.rangeEnd\n        if (exceed > 0) {\n          chunk = chunk.subarray(0, -exceed)\n          this.onData(chunk)\n          urlLoader.onEnd()\n          return\n        }\n      }\n      this.onData(chunk)\n    }\n\n    urlLoader.onEnd = () => {\n      if (this.closed) {\n        return\n      }\n      this.closed = true\n      this.onEnd()\n      this.abort('TASK_DONE')\n    }\n\n    urlLoader.onError = (err) => {\n      this.urlErrs.push({url: urlLoader.url, err})\n      this.urlLoaderSet.delete(urlLoader)\n      this.loadNextUrl()\n    }\n\n    urlLoader.onResponse = (resArgs) => {\n      if (this.opened) {\n        return\n      }\n      if (this.hasRange) {\n        this.buildResRange(resArgs)\n      }\n      this.opened = true\n      this.onOpen(resArgs)\n    }\n\n    urlLoader.request(this)\n  }\n}\n","const enum UpdaterConf {\n  FETCH_TIMEOUT = 1000 * 3,\n\n  DEFAULT_INTERVAL = 1000 * 300,\n  MIN_INTERVAL = 1000,\n\n  SET_SVC_DELAY = 1000 * 5,\n  WS_RETRY_DELAY = 1000 * 20,\n}\n\nconst EMPTY_PARAMS: params_t = new Map()\n\n\nclass Updater {\n  private readonly manifestUrl: string\n  private readonly urlWsMap = new Map<string, WebSocket>()\n  private readonly wsArgs: string = ''\n\n  private updating = false\n  private manifestHash = EMPTY_BUF\n  private pollingTimer = 0\n  private pollingInterval = UpdaterConf.DEFAULT_INTERVAL\n  private lastTime = 0\n  private setSvcTimer = 0\n  private backupUrls: string[] = []\n\n\n  public constructor(\n    manifestPath: string,\n    private onAvailable: (manifest: Manifest) => void\n  ) {\n    const url = new URL(manifestPath, MY_URL)\n    console.assert(url.host === MY_HOST)\n\n    const path = url.pathname + url.search\n    if (path !== DEFAULT_MANIFEST_PATH) {\n      this.wsArgs = '?manifest=' + encodeURIComponent(path)\n    }\n    this.manifestUrl = path\n  }\n\n  private async getManifestFromCache() {\n    const res = await CacheManager.findCache(this.manifestUrl)\n    if (!res) {\n      return\n    }\n    const buf = await res.arrayBuffer()\n    const bin = new Uint8Array(buf)\n\n    // 使用公钥校验缓存配置（缓存可被恶意脚本篡改）\n    if (!await KeyManager.verify(bin)) {\n      return\n    }\n    const txt = bytesToUtf8(bin)\n    const manifest = new Manifest()\n    await manifest.parse(txt)\n    return manifest\n  }\n\n  public async init() {\n    const manifest = await this.getManifestFromCache()\n    if (manifest) {\n      // 先使用本地缓存的配置\n      this.onAvailable(manifest)\n    }\n    await this.update()\n  }\n\n  public async update() {\n    if (this.updating) {\n      return true\n    }\n    const now = Date.now()\n    if (now - this.lastTime < UpdaterConf.MIN_INTERVAL) {\n      return true\n    }\n    this.lastTime = now\n    this.updating = true\n    try {\n      return await this.updateUnsafe()\n    } catch (err) {\n      console.error('[FreeCDN/Updater] update err:', err)\n      return false\n    } finally {\n      this.updating = false\n    }\n  }\n\n  private async updateUnsafe() {\n    // from current site\n    const data = await this.fetchManifest(this.manifestUrl)\n    if (data) {\n      await this.applyManifest(data)\n      return true\n    }\n    console.warn('[FreeCDN/Updater] failed to fetch 1st manifest:', this.manifestUrl)\n\n    if (this.backupUrls.length === 0) {\n      console.warn('[FreeCDN/Updater] no backup url')\n      return false\n    }\n\n    // from backup sites\n    for (const url of this.backupUrls) {\n      const data = await this.fetchManifest(url)\n      if (!data) {\n        console.warn('[FreeCDN/Updater] failed to fetch 3rd manifest:', url)\n        continue\n      }\n      if (!await KeyManager.verify(data)) {\n        console.warn('[FreeCDN/Updater] failed to verify 3rd manifest:', url)\n        continue\n      }\n      await this.applyManifest(data)\n      return true\n    }\n    console.warn('[FreeCDN/Updater] failed to reload')\n    return false\n  }\n\n  private async fetchManifest(url: string) {\n    const ctl = new AbortController()\n    const tid = setTimeout(() => {\n      ctl.abort()\n    }, UpdaterConf.FETCH_TIMEOUT)\n\n    const req = new Request(url, {\n      // https://developer.mozilla.org/en-US/docs/Web/API/Request/cache\n      cache: 'no-cache',\n      signal: ctl.signal,\n    })\n    try {\n      const res = await Network.fetch(req)\n      const bin = await res.arrayBuffer()\n      return new Uint8Array(bin)\n    } catch {\n    } finally {\n      clearTimeout(tid)\n    }\n  }\n\n  private async applyManifest(bytes: Uint8Array) {\n    const hash = await sha256(bytes)\n    if (isArrayEqual(this.manifestHash, hash)) {\n      return\n    }\n    this.manifestHash = hash\n\n    // 缓存最新的清单内容\n    const res = new Response(bytes)\n    res.headers.set('content-length', bytes.length + '')\n    CacheManager.addCache(this.manifestUrl, res)\n\n    const manifest = new Manifest()\n    const txt = bytesToUtf8(bytes)\n\n    await manifest.parse(txt)\n    this.onAvailable(manifest)\n  }\n\n  public applyConfs(params: params_t) {\n    this.backupUrls = this.parseBackupParam(params)\n\n    const interval = this.parseIntervalParam(params)\n    this.setPollingInterval(interval)\n\n    const svcUrls = this.parseServicesParam(params)\n    if (this.setSvcTimer > 0) {\n      clearTimeout(this.setSvcTimer)\n    }\n    // 延时开启，减少对业务的性能影响\n    this.setSvcTimer = setTimeout(() => {\n      this.setSvcTimer = 0\n      this.setServices(svcUrls)\n    }, UpdaterConf.SET_SVC_DELAY)\n  }\n\n  private parseBackupParam(params: params_t) {\n    const str = params.get('backup') || ''\n    return splitList(str)\n  }\n\n  private parseIntervalParam(params: params_t) {\n    const str = params.get('interval')\n    if (str) {\n      const num = parseTime(str)\n      if (!isNaN(num)) {\n        return num\n      }\n      console.warn('[FreeCDN/Updater] invalid interval:', str)\n    }\n    return UpdaterConf.DEFAULT_INTERVAL\n  }\n\n  private parseServicesParam(params: params_t) {\n    const str = params.get('services') || ''\n    return splitList(str)\n  }\n\n  private setPollingInterval(interval: number) {\n    if (this.pollingInterval === interval) {\n      return\n    }\n    this.pollingInterval === interval\n\n    if (this.pollingTimer) {\n      clearInterval(this.pollingTimer)\n    }\n    if (interval > 0) {\n      this.pollingTimer = setInterval(() => {\n        this.update()\n      }, interval)\n    }\n  }\n\n  private setServices(urls: string[]) {\n    for (const [url, ws] of this.urlWsMap) {\n      if (!urls.includes(url)) {\n        ws.onclose = null\n        ws.close()\n        this.urlWsMap.delete(url)\n      }\n    }\n    for (const url of urls) {\n      if (!this.urlWsMap.has(url)) {\n        this.createSvc(url)\n      }\n    }\n  }\n\n  private createSvc(url: string) {\n    const ws = new WebSocket(url + this.wsArgs)\n    ws.binaryType = 'arraybuffer'\n    ws.onmessage = (e) => {\n      const hashBin = new Uint8Array(e.data)\n      if (isArrayEqual(this.manifestHash, hashBin)) {\n        return\n      }\n      this.update()\n    }\n    ws.onclose = () => {\n      this.urlWsMap.delete(url)\n\n      setTimeout(() => {\n        this.createSvc(url)\n      }, UpdaterConf.WS_RETRY_DELAY)\n    }\n    this.urlWsMap.set(url, ws)\n  }\n}","///<reference path=\"global.ts\"/>\n///<reference path=\"param-base.ts\"/>\n///<reference path=\"key-manager.ts\"/>\n///<reference path=\"manifest.ts\"/>\n///<reference path=\"url-conf.ts\"/>\n///<reference path=\"url-loader.ts\"/>\n///<reference path=\"file-conf.ts\"/>\n///<reference path=\"file-loader.ts\"/>\n///<reference path=\"updater.ts\"/>\n\n\nclass FreeCDN {\n  public enableCacheStorage = true\n  public manifest: Manifest | undefined\n\n  private readonly updater: Updater | undefined\n  private weightConf = new Map<string, number>()\n  private inited = false\n\n\n  public constructor(manifestUrl?: string) {\n    if (!manifestUrl) {\n      return\n    }\n    const updater = new Updater(manifestUrl, manifest => {\n      this.manifest = manifest\n\n      const updateConf = manifest.getParams('@update') || EMPTY_PARAMS\n      updater.applyConfs(updateConf)\n\n      // 权重参数\n      this.weightConf = Network.parseWeightConf(manifest)\n    })\n\n    this.updater = updater\n  }\n\n  public async fetch(input: RequestInfo, init?: RequestInit) {\n    const req = (input instanceof Request && !init)\n      ? input\n      : new Request(input, init)\n\n    if (!/^https?:/.test(req.url)) {\n      return NATIVE_FETCH(req)\n    }\n\n    const {manifest} = this\n    if (!manifest) {\n      return Network.fetch(req)\n    }\n\n    let fileConf: FileConf | undefined\n    let suffix = ''\n\n    FIND: for (;;) {\n      const urlObj = new URL(req.url)\n\n      // 同源 URL 使用相对路径，不同源使用完整路径（和清单中格式保持一致）\n      const prefix = urlObj.origin === MY_ORIGIN ? '' : urlObj.origin\n\n      // 带参数的 URL 尝试完整匹配\n      if (urlObj.search) {\n        fileConf = manifest.get(prefix + urlObj.pathname + urlObj.search)\n        if (fileConf) {\n          break\n        }\n      }\n\n      // 合并路径中连续的 `/`\n      const path = urlObj.pathname.replace(/\\/{2,}/g, '/')\n      const file = prefix + path\n\n      // 优先使用 avif、webp 版本\n      if (REG_IMG_EXTS.test(file) && req.mode !== 'cors' && !req.integrity) {\n        const accept = req.headers.get('accept') || ''\n        if (accept.includes('image/avif')) {\n          fileConf = manifest.get(file + '.avif')\n          if (fileConf) {\n            break\n          }\n        }\n        if (accept.includes('image/webp')) {\n          fileConf = manifest.get(file + '.webp')\n          if (fileConf) {\n            break\n          }\n        }\n      }\n\n      fileConf = manifest.get(file)\n      if (fileConf) {\n        break\n      }\n      if (file.endsWith('/')) {\n        fileConf = manifest.get(file + 'index.html')\n        if (fileConf) {\n          break\n        }\n      }\n      // 重定向到 `/` 结尾的路径\n      if (manifest.has(file + '/index.html')) {\n        return Response.redirect(file + '/')\n      }\n\n      // 目录匹配\n      // 尾部保存到 suffix 变量。例如访问 /path/to/file?a=1\n      // 清单若存在 /path/ 文件，suffix 则为 `to/file?a=1`\n\n      // 删除末尾的文件名。保持 `/` 结尾\n      let dir = path.replace(/[^/]*$/, '')\n\n      for (;;) {\n        fileConf = manifest.get(prefix + dir)\n        if (fileConf) {\n          suffix = path.substring(dir.length) + urlObj.search\n          break FIND\n        }\n        if (dir === '/') {\n          break\n        }\n        // 删除末尾的目录名。保持 `/` 结尾\n        dir = dir.replace(/[^/]+\\/$/, '')\n      }\n\n      // 清单中无匹配，直接转发\n      return Network.fetch(req)\n    }\n\n    fileConf.parse()\n\n    let fileHash = ''\n    const hashParam = fileConf.params.get('hash')\n    if (hashParam && hashParam.length === LEN.SHA256_B64) {\n      fileHash = hashParam\n    }\n\n    const range = req.headers.get('range')\n\n    const cacheable = this.enableCacheStorage && fileHash && !range\n    if (cacheable) {\n      const res = await CacheManager.findHash(fileHash)\n      if (res) {\n        return res\n      }\n    }\n\n    const fileLoader = new FileLoader(fileConf, req, manifest, this.weightConf, range, suffix)\n    const promise = promisex<Response>()\n\n    // 如果文件只有一个 hash 则不用流模式（必须完整下载才能校验 hash）\n    if (fileHash) {\n      fileLoader.onOpen = (args) => {\n        fileLoader.onData = (body) => {\n          const res = new Response(body, args)\n          if (cacheable && body.length < 1024 * 1024 * 5) {\n            const cacheRes = res.clone()\n            // 字段可在控制台列表中显示，方便调试\n            cacheRes.headers.set('content-length', body.length + '')\n            cacheRes.headers.set('x-raw-url', req.url)\n            CacheManager.addHash(fileHash, cacheRes)\n          }\n          promise.resolve(res)\n        }\n      }\n      fileLoader.onError = (err) => {\n        console.warn('[FreeCDN]', err.message, err.urlErrs)\n        promise.reject(err)\n      }\n      fileLoader.onEnd = () => {\n      }\n      fileLoader.open()\n      return promise\n    }\n\n    // 如果文件有多个 hash 或没有 hash，可使用流模式\n    let controller: ReadableStreamDefaultController\n    let paused = false\n\n    const checkPressure = () => {\n      const {desiredSize} = controller\n      if (desiredSize === null) {\n        return\n      }\n      if (desiredSize <= 0) {\n        if (!paused) {\n          fileLoader.pause()\n          paused = true\n        }\n      } else {\n        if (paused) {\n          fileLoader.resume()\n          paused = false\n        }\n      }\n    }\n\n    const stream = new ReadableStream({\n      start(c: typeof controller) {\n        controller = c\n      },\n      pull() {\n        checkPressure()\n      },\n      cancel(reason: any) {\n        console.warn('[FreeCDN] stream cancel:', reason)\n        fileLoader.abort(reason)\n      },\n    })\n\n    fileLoader.onData = (chunk) => {\n      controller.enqueue(chunk)\n      checkPressure()\n    }\n    fileLoader.onEnd = () => {\n      controller.close()\n    }\n    fileLoader.onError = (err) => {\n      controller.error()\n      console.warn('[FreeCDN]', err.message, err.urlErrs)\n      promise.reject(err)\n    }\n    fileLoader.onOpen = (args) => {\n      const res = new Response(stream, args)\n      promise.resolve(res)\n    }\n    fileLoader.open()\n    return promise\n  }\n\n  public async fetchText(url: string) {\n    const res = await this.fetch(url)\n    return res.text()\n  }\n\n  public async fetchBin(url: string) {\n    const res = await this.fetch(url)\n    const buf = await res.arrayBuffer()\n    return new Uint8Array(buf)\n  }\n\n  public async fetchBlob(url: string) {\n    const res = await this.fetch(url)\n    const buf = await res.arrayBuffer()\n    const type = res.headers.get('content-type') || ''\n    return new Blob([buf], {type})\n  }\n\n  public async update() {\n    if (this.updater) {\n      return this.updater.update()\n    }\n    return false\n  }\n\n  public async setPublicKey(keyB64: string) {\n    if (keyB64.length !== LEN.PUBKEY_B64) {\n      keyB64 = `MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAE${keyB64}==`\n    }\n    await KeyManager.set(keyB64)\n  }\n\n  public async init() {\n    console.assert(!this.inited)\n    this.inited = true\n\n    await globalInit()\n\n    if (this.updater) {\n      await this.updater.init()\n    }\n  }\n}","//\n// Promise Utils\n//\ntype may_async<T> = T | Promise<T>\n\ntype resolve_t<T> = (value: may_async<T>) => void\ntype reject_t = (reason?: any) => void\n\n\ninterface PromiseX<T = void> extends Promise<T> {\n  readonly resolve: resolve_t<T>\n  readonly reject: reject_t\n}\n\n// non-callback style Promise\nfunction promisex<T = void>() : PromiseX<T> {\n  let resolve: resolve_t<T>\n  let reject: reject_t\n\n  const p = new Promise((a, b) => {\n    resolve = a\n    reject = b\n  }) as PromiseX<T>\n\n  // @ts-ignore\n  p.resolve = resolve\n\n  // @ts-ignore\n  p.reject = reject\n\n  return p\n}\n\n// faster than instanceof\nfunction isPromise(obj: any /* except nullable */ | Promise<any>) : obj is Promise<any> {\n  return typeof obj.then === 'function'\n}","///<reference path=\"../../core-lib/src/freecdn.ts\"/>\n///<reference path=\"../../core-lib/src/promisex.ts\"/>\n///<reference path=\"hook.ts\"/>\n\n\ndeclare const Q: any[]\n\n\nnamespace Sw {\n  const GLOBAL: ServiceWorkerGlobalScope = self as any\n\n  const mLoaderJsRes = new Response('/* freecdn is installed */', {\n    headers: {\n      'content-type': 'text/javascript',\n      'cache-control': 'max-age=3600',\n    },\n  })\n\n  let mFreeCDN: FreeCDN\n\n  let mIniting: PromiseX | null\n  let mResUrlMap: WeakMap<Response, string>\n\n\n  // 共享模式（脚本通过业务方的 SW 引入）\n  function sharedModeInit() {\n    Hook.func(GLOBAL, 'fetch', oldFn => sharedModeHandler)\n\n    Hook.func(Cache.prototype, 'add', oldFn => async function(req) {\n      const res = await sharedModeHandler(req)\n      await this.put(req, res)\n    })\n\n    Hook.func(Cache.prototype, 'addAll', oldFn => async function(reqs) {\n      const tasks = reqs.map(req => this.add(req))\n      await Promise.all(tasks)\n    })\n\n    mResUrlMap = new WeakMap()\n\n    // 由于自定义的 Response 对象 url 为空，因此通过 hook 的方式保留原始 url\n    Hook.prop(Response.prototype, 'url',\n      getter => function() {\n        return mResUrlMap.get(this) || getter.call(this)\n      },\n      /* setter */ null\n    )\n\n    Hook.func(Response.prototype, 'clone', oldFn => function() {\n      const res = oldFn.call(this)\n      const url = mResUrlMap.get(this)\n      if (url) {\n        mResUrlMap.set(res, url)\n      }\n      return res\n    })\n  }\n\n  async function sharedModeHandler(input: RequestInfo, init?: RequestInit) {\n    if (mIniting) {\n      // freecdn 仍在初始化中（例如加载清单文件）\n      await mIniting\n    }\n    const req = (input instanceof Request && !init)\n      ? input\n      : new Request(input, init)\n\n    const res = await mFreeCDN.fetch(req)\n    mResUrlMap.set(res, req.url)\n    return res\n  }\n\n  // 独占模式（通过 freecdn-loader.min.js 引入）\n  function loaderModeInit() {\n    type tuple = Parameters<typeof loaderModeHandler>\n\n    // 重写 Q.push，这样 loader-js 可直接传递 event 和 promise\n    Q.push = loaderModeHandler as any\n\n    while (Q.length) {\n      const args = Q.splice(0, 3) as tuple\n      loaderModeHandler(...args)\n    }\n  }\n\n  function loaderModeHandler(\n    e: FetchEvent,\n    resolve: resolve_t<Response>,\n    reject: reject_t,\n  ) {\n    const req = e.request\n\n    // debug\n    if (req.url.endsWith('/freecdn-update')) {\n      mFreeCDN.update().then(result => {\n        const res = new Response('updated. success: ' + result, {\n          headers: {\n            'content-type': 'text/html',\n          },\n        })\n        resolve(res)\n      })\n      return\n    }\n\n    if (req.url === MY_URL) {\n      resolve(mLoaderJsRes.clone())\n      return\n    }\n\n    mFreeCDN.fetch(req).then(resolve, reject)\n  }\n\n  async function main() {\n    mFreeCDN = new FreeCDN('freecdn-manifest.txt')\n\n    const isSharedMode = !!(GLOBAL as any).FREECDN_SHARED_MODE\n\n    let publicKey: string | undefined\n\n    if (isSharedMode) {\n      mFreeCDN.enableCacheStorage = false\n      mIniting = promisex()\n\n      // 在此之前不要使用 await，否则安装 hook 会被推迟，导致初始化时无法触发 hook\n      sharedModeInit()\n      publicKey = (GLOBAL as any).FREECDN_PUBLIC_KEY\n    } else {\n      publicKey = Q.shift()\n    }\n\n    if (publicKey) {\n      await mFreeCDN.setPublicKey(publicKey)\n    }\n    await mFreeCDN.init()\n\n    if (isSharedMode) {\n      mIniting?.resolve()\n      mIniting = null\n    } else {\n      loaderModeInit()\n    }\n\n    console.log('[FreeCDN] service worker inited')\n  }\n  main()\n}","declare const BR_GLUE_HASH: string\ndeclare const BR_WASM_HASH: string\n\nconst enum ParamBrConf {\n  WASM_LOAD_TIMEOUT = 1000 * 20,\n  IN_BUF_LEN = 1024 * 128,\n  OUT_BUF_LEN = 1024 * 512,\n}\n\nclass ParamBr extends ParamBase {\n  private static hasErr = false\n  private static signal: PromiseX | undefined\n  private static asmMod: any\n\n  private static inPtr: number\n  private static outPtr: number\n\n\n  private static async init() {\n    if (this.signal) {\n      return\n    }\n    this.signal = promisex()\n\n    const BR_WASM_PATH = `${INTERNAL_PATH}/br/br.wasm`\n    const BR_GLUE_PATH = `${INTERNAL_PATH}/br/` + (IS_DEBUG ? 'br.js' : 'br.min.js')\n\n    const BR_MANIFEST = IS_DEBUG ? '' : `\n${BR_WASM_PATH}\n\thttps://cdn.jsdelivr.net/npm/freecdn-js@${VER}/dist/br/br.wasm\n\thttps://unpkg.com/freecdn-js@${VER}/dist/br/br.wasm\n\thttps://code.bdstatic.com/npm/freecdn-js@${VER}/dist/br/br.wasm\n\thttps://npm.elemecdn.com/freecdn-js@${VER}/dist/br/br.wasm\n\thash=${BR_WASM_HASH}\n\n${BR_GLUE_PATH}\n\thttps://cdn.jsdelivr.net/npm/freecdn-js@${VER}/dist/br/br.min.js\n\thttps://unpkg.com/freecdn-js@${VER}/dist/br/br.min.js\n\thttps://code.bdstatic.com/npm/freecdn-js@${VER}/dist/br/br.min.js\n\thttps://npm.elemecdn.com/freecdn-js@${VER}/dist/br/br.min.js\n\thash=${BR_GLUE_HASH}\n`\n    const onError = () => {\n      this.hasErr = true\n      this.signal?.resolve()\n    }\n    const timer = setTimeout(onError, ParamBrConf.WASM_LOAD_TIMEOUT)\n\n    const asmMod: any = {\n      locateFile: () => BR_WASM_PATH,\n      onRuntimeInitialized: () => {\n        this.inPtr = asmMod._AllocInBuf(ParamBrConf.IN_BUF_LEN)\n        this.outPtr = asmMod._AllocOutBuf(ParamBrConf.OUT_BUF_LEN)\n\n        clearTimeout(timer)\n        this.signal?.resolve()\n        this.signal = undefined\n      },\n      onAbort: (reason: any) => {\n        console.warn('[FreeCDN/Br] wasm onAbort:', reason)\n        onError()\n      },\n      print: (msg: any) => {\n        console.warn('[FreeCDN/Br] wasm print:', msg)\n      },\n      printErr: (err: any) => {\n        console.warn('[FreeCDN/Br] wasm printErr:', err)\n      },\n    }\n\n    const manifest = new Manifest()\n    await manifest.parse(BR_MANIFEST)\n\n    const cdn = new FreeCDN()\n    cdn.manifest = manifest\n\n    const onFetch: typeof cdn.fetch = async (...args) => {\n      try {\n        return await cdn.fetch(...args)\n      } catch (err) {\n        console.warn('[FreeCDN/Br] failed to load wasm')\n        onError()\n        throw err\n      }\n    }\n    try {\n      const js = await cdn.fetchText(BR_GLUE_PATH)\n      const fn = Function('Module', 'fetch', js)\n      fn(asmMod, onFetch)\n    } catch {\n      console.warn('[FreeCDN/Br] failed to execute glue js')\n      onError()\n      return\n    }\n    this.asmMod = asmMod\n  }\n\n  public static parseConf(conf: string) {\n    if (conf === 'off') {\n      return\n    }\n    if (conf === 'on') {\n      if (!this.asmMod) {\n        this.init()\n      }\n      return []\n    }\n    return 'invalid value'\n  }\n\n\n  private state = 0\n\n  public constructor() {\n    super()\n  }\n\n  public async onData(chunk: Uint8Array) {\n    if (ParamBr.signal) {\n      await this.waitWasm()\n    }\n    return this.process(chunk)\n  }\n\n  public async onEnd(chunk: Uint8Array) {\n    if (ParamBr.signal) {\n      await this.waitWasm()\n    }\n    // ???\n    let buf = EMPTY_BUF\n    if (chunk.length > 0) {\n      buf = this.process(chunk)\n    }\n    this.destory()\n    return buf\n  }\n\n  private async waitWasm() {\n    await ParamBr.signal\n    if (ParamBr.hasErr) {\n      throw new ParamError('failed to load br decoder')\n    }\n  }\n\n  private process(chunk: Uint8Array) {\n    // brotli/c/include/decode.h\n    const enum RET {\n      ERROR = 0,\n      SUCCESS = 1,\n      NEEDS_MORE_INPUT = 2,\n      NEEDS_MORE_OUTPUT = 3\n    }\n    const asmObj = ParamBr.asmMod\n    const HEAPU8 = asmObj.HEAPU8 as Uint8Array\n\n    if (this.state === 0) {\n      this.state = asmObj._Init()\n    }\n\n    const outBufs: Uint8Array[] = []\n\n    for (let p = 0; p < chunk.length; p += ParamBrConf.IN_BUF_LEN) {\n      const inBuf = chunk.subarray(p, p + ParamBrConf.IN_BUF_LEN)\n      HEAPU8.set(inBuf, ParamBr.inPtr)\n\n      let avaiablelIn = inBuf.length\n      let availableOut = 0\n      do {\n        const ret = asmObj._Update(this.state, 0, avaiablelIn)\n\n        if (ret === RET.ERROR) {\n          const err = asmObj._GetErrorCode()\n          this.destory()\n          throw new ParamError('br decode failed. code: ' + err)\n        }\n        avaiablelIn = asmObj._GetAvailableIn()\n        availableOut = asmObj._GetAvailableOut()\n\n        const len = ParamBrConf.OUT_BUF_LEN - availableOut\n        if (len === 0) {\n          continue\n        }\n        // use slice (copy), not subarray (ref)\n        const outBuf = HEAPU8.slice(ParamBr.outPtr, ParamBr.outPtr + len)\n        outBufs.push(outBuf)\n      } while (asmObj._HasMoreOutput(this.state))\n    }\n\n    if (outBufs.length === 1) {\n      return outBufs[0]\n    }\n    return concatBufs(outBufs)\n  }\n\n  private destory() {\n    ParamBr.asmMod._Destroy(this.state)\n  }\n}\n","type bundle_file_map_t = Map<string /* path */, Response>\n\nclass ParamBundle extends ParamBase {\n\n  public static parseConf(conf: string) {\n    if (conf === 'off') {\n      return\n    }\n    if (!/^https?:|^\\//.test(conf)) {\n      return 'invalid url'\n    }\n    return [conf]\n  }\n\n  private static cacheMap = new Map<string /* pkgUrl */,\n    may_async<bundle_file_map_t>\n  >()\n\n\n  public constructor(\n    private readonly packUrl: string\n  ) {\n    super()\n  }\n\n  public async onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) {\n    let fileMap: bundle_file_map_t\n\n    const r = ParamBundle.cacheMap.get(this.packUrl)\n    if (r === undefined) {\n      const map = await this.loadPkg(fileLoader.manifest)\n      if (!map) {\n        return\n      }\n      fileMap = map\n    } else if (isPromise(r)) {\n      fileMap = await r\n    } else {\n      fileMap = r\n    }\n\n    const path = fileLoader.suffix\n    const res = fileMap.get(path)\n    if (res) {\n      return res.clone()\n    }\n    if (path === '') {\n      const res = fileMap.get('index.html')\n      if (res) {\n        fileLoader.suffix = 'index.html'\n        return res.clone()\n      }\n    }\n    if (path.endsWith('/')) {\n      const res = fileMap.get(path + 'index.html')\n      if (res) {\n        fileLoader.suffix = path + 'index.html'\n        return res.clone()\n      }\n    }\n    if (fileMap.has(path + '/index.html')) {\n      fileLoader.suffix = path + '/index.html'\n      const redir = fileLoader.fileConf.name + path + '/'\n      return new Response(`<meta http-equiv=\"Refresh\" content=\"0;url=${redir}\">`)\n    }\n  }\n\n  private async loadPkg(manifest: Manifest) {\n    type conf_t = {\n      [file: string]: {\n        [headerName: string] : string | number\n      }\n    }\n    const fileMap: bundle_file_map_t = new Map()\n    const signal = promisex<bundle_file_map_t>()\n\n    ParamBundle.cacheMap.set(this.packUrl, signal)\n\n    // TODO: support stream\n\n    let pkgBin: Uint8Array\n    try {\n      if (manifest.has(this.packUrl)) {\n        const cdn = new FreeCDN()\n        cdn.manifest = manifest\n        pkgBin = await cdn.fetchBin(this.packUrl)\n      } else {\n        // 资源包不在清单中，或不是普通文件（例如是目录），则直接加载，防止循环依赖\n        const res = await NATIVE_FETCH(this.packUrl)\n        const buf = await res.arrayBuffer()\n        pkgBin = new Uint8Array(buf)\n      }\n    } catch {\n      this.warn('failed to load')\n      return\n    }\n\n    const pos = pkgBin.indexOf(13 /* '\\r' */)\n    if (pos === -1) {\n      this.warn('missing header')\n      return\n    }\n    const confBin = pkgBin.subarray(0, pos)\n    const confMap: conf_t = parseJson(bytesToUtf8(confBin))\n    if (!confMap) {\n      this.warn('invalid header')\n      return\n    }\n\n    const bodyBin = pkgBin.subarray(pos + 1)\n    let offset = 0\n\n    for (const [file, conf] of Object.entries(confMap)) {\n      const len = +conf['content-length']\n      if (!(len >= 0)) {\n        this.warn('invalid content-length')\n        return\n      }\n      if (offset + len > bodyBin.length) {\n        this.warn('invalid offset')\n        return\n      }\n      const fileBuf = bodyBin.subarray(offset, offset + len)\n      const res = new Response(fileBuf, {\n        headers: confMap[file] as HeadersInit\n      })\n      fileMap.set(file, res)\n\n      offset += len\n    }\n\n    ParamBundle.cacheMap.set(this.packUrl, fileMap)\n    signal.resolve(fileMap)\n    return fileMap\n  }\n\n  private warn(msg: string) {\n    console.warn('[FreeCDN/Bundle]', msg, this.packUrl)\n  }\n}","const REG_TEXT_MIME = /^text\\/|^application\\/(?:javascript|json)|\\+xml$/\n\n\nclass ParamCharset extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    if (conf !== 'off') {\n      return [conf]\n    }\n  }\n\n\n  public constructor(\n    private readonly charset: string\n  ) {\n    super()\n  }\n\n  public onResponse(resArgs: ResponseArgs) {\n    const type = resArgs.headers.get('content-type') || ''\n    if (REG_TEXT_MIME.test(type)) {\n      resArgs.headers.set('content-type', type + '; charset=' + this.charset)\n    }\n  }\n}\n","class ParamData extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    const bytes = parseStrOrB64(conf)\n    if (!bytes) {\n      return 'invalid format'\n    }\n    return [bytes]\n  }\n\n\n  public constructor(\n    private readonly bytes: Uint8Array\n  ) {\n    super()\n  }\n\n  public onRequest() {\n    return new Response(this.bytes)\n  }\n}\n","class ParamExpires extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    const time = parseTime(conf)\n    if (isNaN(time)) {\n      return 'invalid time format'\n    }\n    const seconds = time / 1000 | 0\n    return [seconds]\n  }\n\n\n  public constructor(\n    private readonly seconds: number\n  ) {\n    super()\n  }\n\n  public onResponse(resArgs: ResponseArgs, fileLoader: FileLoader, rawRes: Response) {\n    // 过期时间不小于实际值，防止经常变化的资源无法及时更新\n    const rawMaxAge = (rawRes as any)._maxage\n    const maxAge = rawMaxAge < this.seconds ? rawMaxAge : this.seconds\n\n    resArgs.headers.append('cache-control', 'max-age=' + maxAge)\n  }\n}\n","const enum ParamHashConf {\n  MAX_QUEUE_LEN = 64 * 1024 * 1024\n}\n\nclass ParamHash extends ParamBase {\n\n  public static parseConf(conf: string) {\n    // conf format:\n    // [blksize;]hash1,hash2,...\n    let blkLen = 1e9\n    let hashes = conf\n\n    const pos = conf.indexOf(';')\n    if (pos > 0) {\n      const blkLenStr = conf.substring(0, pos)\n      hashes = conf.substring(pos + 1)\n      blkLen = parseByteUnit(blkLenStr)\n      if (isNaN(blkLen)) {\n        return 'invalid block length'\n      }\n    }\n    const hashBins: Uint8Array[] = []\n    const hashB64s = hashes.split(',')\n\n    // 倒序存储，之后 pop 取出\n    for (let i = hashB64s.length - 1; i !== -1; i--) {\n      const bin = base64Decode(hashB64s[i])\n      if (!bin || bin.length !== LEN.SHA256_BIN) {\n        return 'invalid block hash'\n      }\n      hashBins.push(bin)\n    }\n    return [blkLen, hashBins]\n  }\n\n\n  private readonly queueArr: Uint8Array[] = []\n  private queueLen = 0\n  private hasData = false\n\n  public constructor(\n    private readonly blkLen: number,\n    private readonly hashBins: Uint8Array[]\n  ) {\n    super()\n  }\n\n  public async onData(chunk: Uint8Array) {\n    this.hasData = true\n    this.queueLen += chunk.length\n\n    if (this.queueLen > ParamHashConf.MAX_QUEUE_LEN) {\n      throw new ParamError('max queue length exceeded')\n    }\n\n    if (this.queueLen >= this.blkLen) {\n      // let queueLen be integer multiple of blkLen\n      const remain = this.queueLen % this.blkLen\n      if (remain) {\n        const head = chunk.subarray(0, -remain)\n        this.queueArr.push(head)\n        this.queueLen -= remain\n      } else {\n        this.queueArr.push(chunk)\n      }\n      const blks = await this.pull()\n      this.queueLen = remain\n\n      if (remain) {\n        const tail = chunk.subarray(-remain)\n        this.queueArr.push(tail)\n      }\n      return blks\n    }\n\n    this.queueArr.push(chunk)\n    return EMPTY_BUF\n  }\n\n  public async onEnd(chunk: Uint8Array) {\n    if (chunk.length > 0) {\n      this.queueLen += chunk.length\n      this.queueArr.push(chunk)\n    }\n    if (this.queueLen === 0) {\n      if (!this.hasData) {\n        await this.verify(EMPTY_BUF)\n      }\n      return EMPTY_BUF\n    }\n    return this.pull()\n  }\n\n  private async pull() {\n    const blks = concatBufs(this.queueArr, this.queueLen)\n    this.queueArr.length = 0\n\n    for (let p = 0; p < blks.length; p += this.blkLen) {\n      const blk = blks.subarray(p, p + this.blkLen)\n      await this.verify(blk)\n    }\n    return blks\n  }\n\n  private async verify(blk: Uint8Array) {\n    const hashExp = this.hashBins.pop()\n    if (!hashExp) {\n      throw new ParamError('missing hash')\n    }\n    const hashGot = await sha256(blk)\n\n    if (!isArrayEqual(hashExp, hashGot)) {\n      const exp = base64Encode(hashExp)\n      const got = base64Encode(hashGot)\n      throw new ParamError(`hash incorrect. expected: ${exp}, but got: ${got}`)\n    }\n  }\n}\n","class ParamHeaders extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    return ParamReqHeaders.parse(conf)\n  }\n\n\n  public constructor(\n    private readonly headers: readonly [string, string][],\n    private readonly preserveAll: boolean\n  ) {\n    super()\n  }\n\n  public onResponse(resArgs: ResponseArgs, fileLoader: FileLoader, rawRes: Response) {\n    if (this.preserveAll) {\n      for (const [k, v] of rawRes.headers) {\n        resArgs.headers.set(k, v)\n      }\n      for (const [k, v] of this.headers) {\n        resArgs.headers.set(k, v)\n      }\n      return\n    }\n\n    for (const [k, v] of this.headers) {\n      if (v === '') {\n        // preserve\n        const rawVal = rawRes.headers.get(k)\n        if (rawVal !== null) {\n          resArgs.headers.set(k, rawVal)\n        }\n      } else {\n        // add\n        resArgs.headers.set(k, v)\n      }\n    }\n  }\n}\n","class ParamOpenTimeout extends ParamBase {\n\n  public static parseConf(conf: string) {\n    const time = parseTime(conf)\n    if (isNaN(time)) {\n      return 'invalid time format'\n    }\n    return [time]\n  }\n\n\n  private tid = 0\n\n\n  public constructor(\n    private readonly time: number,\n  ) {\n    super()\n  }\n\n  public onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) {\n    this.tid = setTimeout(() => {\n      const delay = Math.max(this.time, 5000)\n      fileLoader.loadNextUrl(delay)\n    }, this.time)\n  }\n\n  public onResponse() {\n    this.stopTimer()\n  }\n\n  public onError() {\n    this.stopTimer()\n  }\n\n  public onAbort() {\n    this.stopTimer()\n  }\n\n  private stopTimer() {\n    if (this.tid > 0) {\n      clearTimeout(this.tid)\n      this.tid = 0\n    }\n  }\n}\n","class ParamPos extends ParamBase {\n\n  public static parseConf(conf: string) {\n    const begin = parseByteUnit(conf)\n    if (isNaN(begin)) {\n      return 'invalid byte format'\n    }\n    if (begin === 0) {\n      return\n    }\n    return [begin]\n  }\n\n\n  private remain: number\n\n\n  public constructor(pos: number) {\n    super()\n    this.remain = pos\n  }\n\n  public onData(chunk: Uint8Array) {\n    if (this.remain <= 0) {\n      return chunk\n    }\n    const remain = (this.remain -= chunk.length)\n    if (remain >= 0) {\n      return EMPTY_BUF\n    }\n    // if remain < 0, return last -remain bytes\n    return chunk.subarray(remain)\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    return this.onData(chunk)\n  }\n}","class ParamPrefix extends ParamBase {\n\n  public static parseConf(conf: string) {\n    const bytes = parseStrOrB64(conf)\n    if (!bytes) {\n      return 'invalid format'\n    }\n    return [bytes]\n  }\n\n\n  private done = false\n\n  public constructor(\n    private readonly bytes: Uint8Array\n  ) {\n    super()\n  }\n\n  public onData(chunk: Uint8Array) {\n    if (this.done) {\n      return chunk\n    }\n    this.done = true\n    return concatBufs([this.bytes, chunk])\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    // for empty file\n    return this.onData(chunk)\n  }\n}\n","class ParamRecvTimeout extends ParamBase {\n\n  public static parseConf(conf: string) {\n    const [n, t] = conf.split('/')\n    const bytes = parseByteUnit(n)\n    const time = parseTime(t)\n    if (isNaN(bytes)) {\n      return 'invalid byte format'\n    }\n    if (isNaN(time)) {\n      return 'invalid time format'\n    }\n    return [bytes, time]\n  }\n\n\n  private fileLoader!: FileLoader\n  private tid = 0\n  private sum = 0\n\n  public constructor(\n    private readonly bytes: number,\n    private readonly time: number,\n  ) {\n    super()\n  }\n\n  public onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) {\n    this.fileLoader = fileLoader\n  }\n\n  public onResponse() {\n    this.tid = setInterval(() => {\n      if (this.sum <= this.bytes) {\n        this.stopTimer()\n        this.fileLoader.loadNextUrl()\n      }\n      this.sum = 0\n    }, this.time)\n  }\n\n  public onData(chunk: Uint8Array) {\n    this.sum += chunk.length\n    return chunk\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    this.stopTimer()\n    return chunk\n  }\n\n  public onError() {\n    this.stopTimer()\n  }\n\n  public onAbort() {\n    this.stopTimer()\n  }\n\n  private stopTimer() {\n    if (this.tid > 0) {\n      clearInterval(this.tid)\n      this.tid = 0\n    }\n  }\n}\n","const REG_REFFERER_POLICY = /^(?:no-referrer|unsafe-url|origin|same-origin|strict-origin|no-referrer-when-downgrade|origin-when-cross-origin|strict-origin-when-cross-origin)$/\n\n\nclass ParamReferrerPolicy extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    if (conf === 'raw') {\n      return ['']\n    }\n    if (!REG_REFFERER_POLICY.test(conf)) {\n      return 'invalid value'\n    }\n    return [conf]\n  }\n\n\n  public constructor(\n    private readonly policy: ReferrerPolicy\n  ) {\n    super()\n  }\n\n  public onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) {\n    reqArgs.referrerPolicy = this.policy || fileLoader.rawReq.referrerPolicy\n  }\n}\n","class ParamReqHeaders extends ParamBase {\n  public static reuse = true\n\n  public static parse(conf: string) {\n    const headers: [string, string][] = []\n    let preserveAll = false\n\n    // {\"header-to-preserve\": \"\", \"header-to-add\": \"val\"}\n    const map = parseJson(conf)\n    if (typeof map !== 'object') {\n      return 'invalid format'\n    }\n    for (const [k, v] of Object.entries(map)) {\n      if (k === '*') {\n        preserveAll = true\n      } else {\n        headers.push([k, v + ''])\n      }\n    }\n    return [headers, preserveAll]\n  }\n\n  public static parseConf(conf: string) {\n    return this.parse(conf)\n  }\n\n\n  public constructor(\n    private readonly headers: readonly [string, string][],\n    private readonly preserveAll: boolean\n  ) {\n    super()\n  }\n\n  public onRequest(reqArgs: RequestArgs, fileLoader: FileLoader) {\n    const {rawReq} = fileLoader\n\n    if (this.preserveAll) {\n      for (const [k, v] of rawReq.headers) {\n        reqArgs.headers.set(k, v)\n      }\n      for (const [k, v] of this.headers) {\n        reqArgs.headers.set(k, v)\n      }\n      return\n    }\n\n    for (const [k, v] of this.headers) {\n      if (k === 'referer') {\n        reqArgs.referrer = v || rawReq.referrer\n        continue\n      }\n      if (v === '') {\n        // preserve\n        const rawVal = rawReq.headers.get(k)\n        if (rawVal !== null) {\n          reqArgs.headers.set(k, rawVal)\n        }\n      } else {\n        // add\n        reqArgs.headers.set(k, v)\n      }\n    }\n  }\n}\n","class ParamSize extends ParamBase {\n\n  public static parseConf(conf: string) {\n    const size = parseByteUnit(conf)\n    if (isNaN(size)) {\n      return 'invalid byte format'\n    }\n    return [size]\n  }\n\n\n  private remain: number\n\n  public constructor(size: number) {\n    super()\n    this.remain = size\n  }\n\n  public onData(chunk: Uint8Array) {\n    if (this.remain <= 0) {\n      return EMPTY_BUF\n    }\n    const remain = (this.remain -= chunk.length)\n    if (remain >= 0) {\n      return chunk\n    }\n    // remain < 0, return [0, END + remain)\n    return chunk.subarray(0, remain)\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    return this.onData(chunk)\n  }\n}\n","const enum ParamStreamConf {\n  MAX_QUEUE_LEN = 64 * 1024 * 1024\n}\n\nclass ParamStream extends ParamBase {\n\n  public static parseConf(conf: string) {\n    if (conf === 'on') {\n      // default\n      return\n    }\n    if (conf === 'off') {\n      return []\n    }\n    return 'invalid value'\n  }\n\n\n  private readonly queueArr: Uint8Array[] = []\n  private queueLen = 0\n\n  public constructor() {\n    super()\n  }\n\n  public onData(chunk: Uint8Array) {\n    this.queueLen += chunk.length\n    if (this.queueLen > ParamStreamConf.MAX_QUEUE_LEN) {\n      throw new ParamError('max queue length exceeded')\n    }\n    this.queueArr.push(chunk)\n    return EMPTY_BUF\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    if (chunk.length > 0) {\n      // unlikely\n      this.onData(chunk)\n    }\n    return concatBufs(this.queueArr, this.queueLen)\n  }\n}\n","class ParamSuffix extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    const bytes = parseStrOrB64(conf)\n    if (!bytes) {\n      return 'invalid format'\n    }\n    return [bytes]\n  }\n\n\n  public constructor(\n    private readonly bytes: Uint8Array\n  ) {\n    super()\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    if (chunk.length === 0) {\n      return this.bytes\n    }\n    return concatBufs([chunk, this.bytes])\n  }\n}\n","class ParamValidStatus extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    if (conf === '*') {\n      return\n    }\n    const codes = conf.split(',').map(Number)\n    return [codes]\n  }\n\n\n  public constructor(\n    private readonly codes: number[]\n  ) {\n    super()\n  }\n\n  public onResponse(resArgs: ResponseArgs, fileLoader: FileLoader, rawRes: Response) {\n    if (!this.codes.includes(rawRes.status)) {\n      throw new ParamError('invalid http status: ' + rawRes.status)\n    }\n  }\n}\n","class ParamXor extends ParamBase {\n  public static reuse = true\n\n  public static parseConf(conf: string) {\n    const key = +conf | 0\n    if (key < 0 || key > 255) {\n      return 'invalid value'\n    }\n    return [key]\n  }\n\n\n  public constructor(\n    private readonly key: number\n  ) {\n    super()\n  }\n\n  public onData(chunk: Uint8Array) {\n    // TODO: u32 optimize\n    for (let i = 0; i < chunk.length; i++) {\n      chunk[i] ^= this.key\n    }\n    return chunk\n  }\n\n  public onEnd(chunk: Uint8Array) {\n    return this.onData(chunk)\n  }\n}\n","const MIME_DATA = 'application/andrew-inset:ez;application/applixware:aw;application/atom+xml:atom;application/atomcat+xml:atomcat;application/atomdeleted+xml:atomdeleted;application/atomsvc+xml:atomsvc;application/atsc-dwd+xml:dwd;application/atsc-held+xml:held;application/atsc-rsat+xml:rsat;application/bdoc:bdoc;application/calendar+xml:xcs;application/ccxml+xml:ccxml;application/cdfx+xml:cdfx;application/cdmi-capability:cdmia;application/cdmi-container:cdmic;application/cdmi-domain:cdmid;application/cdmi-object:cdmio;application/cdmi-queue:cdmiq;application/cu-seeme:cu;application/dash+xml:mpd;application/davmount+xml:davmount;application/docbook+xml:dbk;application/dssc+der:dssc;application/dssc+xml:xdssc;application/ecmascript:ecma,es;application/emma+xml:emma;application/emotionml+xml:emotionml;application/epub+zip:epub;application/exi:exi;application/fdt+xml:fdt;application/font-tdpfr:pfr;application/geo+json:geojson;application/gml+xml:gml;application/gpx+xml:gpx;application/gxf:gxf;application/gzip:gz;application/hjson:hjson;application/hyperstudio:stk;application/inkml+xml:ink,inkml;application/ipfix:ipfix;application/its+xml:its;application/java-archive:jar,war,ear;application/java-serialized-object:ser;application/java-vm:class;application/javascript:js,mjs;application/json:json,map;application/json5:json5;application/jsonml+json:jsonml;application/ld+json:jsonld;application/lgr+xml:lgr;application/lost+xml:lostxml;application/mac-binhex40:hqx;application/mac-compactpro:cpt;application/mads+xml:mads;application/manifest+json:webmanifest;application/marc:mrc;application/marcxml+xml:mrcx;application/mathematica:ma,nb,mb;application/mathml+xml:mathml;application/mbox:mbox;application/mediaservercontrol+xml:mscml;application/metalink+xml:metalink;application/metalink4+xml:meta4;application/mets+xml:mets;application/mmt-aei+xml:maei;application/mmt-usd+xml:musd;application/mods+xml:mods;application/mp21:m21,mp21;application/mp4:mp4s,m4p;application/mrb-consumer+xml:xdf;application/mrb-publish+xml:xdf;application/msword:doc,dot;application/mxf:mxf;application/n-quads:nq;application/n-triples:nt;application/node:cjs;application/octet-stream:bin,dms,lrf,mar,so,dist,distz,pkg,bpk,dump,elc,deploy,exe,dll,deb,dmg,iso,img,msi,msp,msm,buffer;application/oda:oda;application/oebps-package+xml:opf;application/ogg:ogx;application/omdoc+xml:omdoc;application/onenote:onetoc,onetoc2,onetmp,onepkg;application/oxps:oxps;application/p2p-overlay+xml:relo;application/patch-ops-error+xml:xer;application/pdf:pdf;application/pgp-encrypted:pgp;application/pgp-signature:asc,sig;application/pics-rules:prf;application/pkcs10:p10;application/pkcs7-mime:p7m,p7c;application/pkcs7-signature:p7s;application/pkcs8:p8;application/pkix-attr-cert:ac;application/pkix-cert:cer;application/pkix-crl:crl;application/pkix-pkipath:pkipath;application/pkixcmp:pki;application/pls+xml:pls;application/postscript:ai,eps,ps;application/provenance+xml:provx;application/pskc+xml:pskcxml;application/raml+yaml:raml;application/rdf+xml:rdf,owl;application/reginfo+xml:rif;application/relax-ng-compact-syntax:rnc;application/resource-lists+xml:rl;application/resource-lists-diff+xml:rld;application/rls-services+xml:rs;application/route-apd+xml:rapd;application/route-s-tsid+xml:sls;application/route-usd+xml:rusd;application/rpki-ghostbusters:gbr;application/rpki-manifest:mft;application/rpki-roa:roa;application/rsd+xml:rsd;application/rss+xml:rss;application/rtf:rtf;application/sbml+xml:sbml;application/scvp-cv-request:scq;application/scvp-cv-response:scs;application/scvp-vp-request:spq;application/scvp-vp-response:spp;application/sdp:sdp;application/senml+xml:senmlx;application/sensml+xml:sensmlx;application/set-payment-initiation:setpay;application/set-registration-initiation:setreg;application/shf+xml:shf;application/sieve:siv,sieve;application/smil+xml:smi,smil;application/sparql-query:rq;application/sparql-results+xml:srx;application/srgs:gram;application/srgs+xml:grxml;application/sru+xml:sru;application/ssdl+xml:ssdl;application/ssml+xml:ssml;application/swid+xml:swidtag;application/tei+xml:tei,teicorpus;application/thraud+xml:tfi;application/timestamped-data:tsd;application/toml:toml;application/ttml+xml:ttml;application/ubjson:ubj;application/urc-ressheet+xml:rsheet;application/urc-targetdesc+xml:td;application/voicexml+xml:vxml;application/wasm:wasm;application/widget:wgt;application/winhlp:hlp;application/wsdl+xml:wsdl;application/wspolicy+xml:wspolicy;application/xaml+xml:xaml;application/xcap-att+xml:xav;application/xcap-caps+xml:xca;application/xcap-diff+xml:xdf;application/xcap-el+xml:xel;application/xcap-error+xml:xer;application/xcap-ns+xml:xns;application/xenc+xml:xenc;application/xhtml+xml:xhtml,xht;application/xliff+xml:xlf;application/xml:xml,xsl,xsd,rng;application/xml-dtd:dtd;application/xop+xml:xop;application/xproc+xml:xpl;application/xslt+xml:xsl,xslt;application/xspf+xml:xspf;application/xv+xml:mxml,xhvml,xvml,xvm;application/yang:yang;application/yin+xml:yin;application/zip:zip;audio/3gpp:3gpp;audio/adpcm:adp;audio/amr:amr;audio/basic:au,snd;audio/midi:mid,midi,kar,rmi;audio/mobile-xmf:mxmf;audio/mp3:mp3;audio/mp4:m4a,mp4a;audio/mpeg:mpga,mp2,mp2a,mp3,m2a,m3a;audio/ogg:oga,ogg,spx,opus;audio/s3m:s3m;audio/silk:sil;audio/wav:wav;audio/wave:wav;audio/webm:weba;audio/xm:xm;font/collection:ttc;font/otf:otf;font/ttf:ttf;font/woff:woff;font/woff2:woff2;image/aces:exr;image/apng:apng;image/avif:avif;image/bmp:bmp;image/cgm:cgm;image/dicom-rle:drle;image/emf:emf;image/fits:fits;image/g3fax:g3;image/gif:gif;image/heic:heic;image/heic-sequence:heics;image/heif:heif;image/heif-sequence:heifs;image/hej2k:hej2;image/hsj2:hsj2;image/ief:ief;image/jls:jls;image/jp2:jp2,jpg2;image/jpeg:jpeg,jpg,jpe;image/jph:jph;image/jphc:jhc;image/jpm:jpm;image/jpx:jpx,jpf;image/jxr:jxr;image/jxra:jxra;image/jxrs:jxrs;image/jxs:jxs;image/jxsc:jxsc;image/jxsi:jxsi;image/jxss:jxss;image/ktx:ktx;image/ktx2:ktx2;image/png:png;image/sgi:sgi;image/svg+xml:svg,svgz;image/t38:t38;image/tiff:tif,tiff;image/tiff-fx:tfx;image/webp:webp;image/wmf:wmf;message/disposition-notification:disposition-notification;message/global:u8msg;message/global-delivery-status:u8dsn;message/global-disposition-notification:u8mdn;message/global-headers:u8hdr;message/rfc822:eml,mime;model/3mf:3mf;model/gltf+json:gltf;model/gltf-binary:glb;model/iges:igs,iges;model/mesh:msh,mesh,silo;model/mtl:mtl;model/obj:obj;model/stl:stl;model/vrml:wrl,vrml;model/x3d+binary:x3db,x3dbz;model/x3d+fastinfoset:x3db;model/x3d+vrml:x3dv,x3dvz;model/x3d+xml:x3d,x3dz;model/x3d-vrml:x3dv;text/cache-manifest:appcache,manifest;text/calendar:ics,ifb;text/coffeescript:coffee,litcoffee;text/css:css;text/csv:csv;text/html:html,htm,shtml;text/jade:jade;text/jsx:jsx;text/less:less;text/markdown:markdown,md;text/mathml:mml;text/mdx:mdx;text/n3:n3;text/plain:txt,text,conf,def,list,log,in,ini;text/richtext:rtx;text/rtf:rtf;text/sgml:sgml,sgm;text/shex:shex;text/slim:slim,slm;text/spdx:spdx;text/stylus:stylus,styl;text/tab-separated-values:tsv;text/troff:t,tr,roff,man,me,ms;text/turtle:ttl;text/uri-list:uri,uris,urls;text/vcard:vcard;text/vtt:vtt;text/xml:xml;text/yaml:yaml,yml;video/3gpp:3gp,3gpp;video/3gpp2:3g2;video/h261:h261;video/h263:h263;video/h264:h264;video/iso.segment:m4s;video/jpeg:jpgv;video/jpm:jpm,jpgm;video/mj2:mj2,mjp2;video/mp2t:ts;video/mp4:mp4,mp4v,mpg4;video/mpeg:mpeg,mpg,mpe,m1v,m2v;video/ogg:ogv;video/quicktime:qt,mov;video/webm:webm'\n","class ParamMime extends ParamBase {\n  public static reuse = true\n\n  private static extTypeMap: ReadonlyMap<string, string>\n  static {\n    const map = new Map<string, string>()\n\n    for (const item of MIME_DATA.split(';')) {\n      const [mime, exts] = getPair(item, ':') as string[]\n\n      for (const ext of exts.split(',')) {\n        map.set(ext, mime)\n      }\n    }\n    this.extTypeMap = map\n  }\n\n  public static parseConf(conf: string) {\n    if (conf === 'auto') {\n      // likely\n      return ['']\n    }\n    return [conf]\n  }\n\n\n  public constructor(\n    private readonly mime: string\n  ) {\n    super()\n  }\n\n  public onResponse(resArgs: ResponseArgs, fileLoader: FileLoader, rawRes: Response) {\n    let type: string | undefined\n\n    if (this.mime === '') {\n      const url = fileLoader.getFileConfUrl()\n      if (!url.includes('?')) {\n        const m = url.match(/\\.(\\w+)$/)\n        if (m) {\n          const ext = m[1].toLowerCase()\n          type = ParamMime.extTypeMap.get(ext)\n        }\n      }\n      if (!type) {\n        const rawType = rawRes.headers.get('content-type')\n        if (rawType) {\n          type = getPair(rawType, ';')[0]\n        } else {\n          type = 'application/octet-stream'\n        }\n      }\n    } else {\n      type = this.mime\n    }\n    resArgs.headers.set('content-type', type)\n  }\n}\n","namespace CacheManager {\n  let mCache: Cache\n\n  // TODO: LRU\n\n  export async function init() {\n    if (!mCache) {\n      mCache = await caches.open('.freecdn')\n    }\n  }\n\n  export async function findHash(hash: string) {\n    const res = await findCache('/' + hash)\n    if (!res) {\n      return\n    }\n    const buf = await res.clone().arrayBuffer()\n    const bin = new Uint8Array(buf)\n    const hashGot = await sha256(bin)\n    const hashExp = base64Decode(hash)\n    if (!hashExp) {\n      return\n    }\n    if (!isArrayEqual(hashGot, hashExp)) {\n      console.warn('[FreeCDN/CacheManager] bad cache:', hash)\n      delCache('/' + hash)\n      return\n    }\n    return res\n  }\n\n  export async function addHash(hash: string, res: Response) {\n    await addCache('/' + hash, res)\n  }\n\n  export function findCache(reqInfo: RequestInfo) {\n    return mCache.match(reqInfo)\n  }\n\n  export async function addCache(reqInfo: RequestInfo, res: Response) {\n    try {\n      await mCache.put(reqInfo, res)\n    } catch {\n    }\n  }\n\n  export function delCache(reqInfo: RequestInfo) {\n    return mCache.delete(reqInfo)\n  }\n}\n","class Database {\n  private db!: IDBDatabase\n\n\n  public constructor(\n    private readonly name: string\n  ) {\n  }\n\n  public open(opts: {\n    [table: string] : IDBObjectStoreParameters\n  }) {\n    const s = promisex()\n    const req = indexedDB.open(this.name)\n\n    req.onsuccess = () => {\n      const idb = req.result\n      this.db = idb\n\n      idb.onclose = () => {\n        console.warn('[FreeCDN/Database] indexedDB disconnected, reopen...')\n        this.open(opts)\n      }\n      s.resolve()\n    }\n    req.onerror = (e) => {\n      console.warn('[FreeCDN/Database] indexedDB open error:', e)\n      s.reject(req.error)\n    }\n    req.onupgradeneeded = () => {\n      const idb = req.result\n      for (const [k, v] of Object.entries(opts)) {\n        idb.createObjectStore(k, v)\n      }\n    }\n    return s\n  }\n\n  public close() {\n    this.db.close()\n  }\n\n  public get(table: string, key: any) {\n    const s = promisex<any>()\n    const obj = this.getStore(table, 'readonly')\n    const req = obj.get(key)\n\n    req.onsuccess = () => {\n      s.resolve(req.result)\n    }\n    req.onerror = () => {\n      s.reject(req.error)\n    }\n    return s\n  }\n\n  public put(table: string, record: any) {\n    const s = promisex()\n    const obj = this.getStore(table, 'readwrite')\n    const req = obj.put(record)\n\n    req.onsuccess = () => {\n      s.resolve()\n    }\n    req.onerror = () => {\n      s.reject(req.error)\n    }\n    return s\n  }\n\n  public delete(table: string, key: any) {\n    const s = promisex()\n    const obj = this.getStore(table, 'readwrite')\n    const req = obj.delete(key)\n\n    req.onsuccess = () => {\n      s.resolve()\n    }\n    req.onerror = () => {\n      s.reject(req.error)\n    }\n    return s\n  }\n\n  public enum(\n    table: string,\n    callback: (result: any) => boolean | void,\n    ...args: Parameters<typeof IDBObjectStore.prototype.openCursor>\n  ) {\n    const s = promisex()\n    const obj = this.getStore(table, 'readonly')\n    const req = obj.openCursor(...args)\n\n    req.onsuccess = () => {\n      const {result} = req\n      if (!result) {\n        s.resolve()\n        return\n      }\n      const ret = callback(result.value)\n      if (ret !== false) {\n        result.continue()\n      }\n    }\n    req.onerror = () => {\n      s.reject(req.error)\n    }\n    return s\n  }\n\n  private getStore(table: string, mode: IDBTransactionMode) {\n    return this.db\n      .transaction(table, mode)\n      .objectStore(table)\n  }\n}\n","namespace Network {\n  const enum Conf {\n    DEFAULT_MAX_AGE = 300,\n  }\n\n  const mDatabase = new Database('.freecdn')\n\n  interface UrlInfo {\n    url: string,\n    status: number,\n    expire: number,\n  }\n  const mUrlInfoMap = new Map<string, UrlInfo>()\n\n  function addUrlInfo(url: string, status: number, expire: number) {\n    if (mUrlInfoMap.has(url)) {\n      return\n    }\n    const info: UrlInfo = {url, status, expire}\n    mUrlInfoMap.set(url, info)\n\n    mDatabase.put('cache', info)\n  }\n\n\n  class HostInfo {\n    public lastDoneTime = 0\n    public lastErrTime = 0\n\n    public pending = 0\n    // public protocol = 1\n\n    public errNum = 0\n    public reqNum = 0\n    public reqTimeAvg = -1\n    public reqTimeSum = 0\n    // public speedAvg = 0\n    // public speedSum = 0\n  }\n  const mHostInfoMap = new Map<string, HostInfo>()\n\n  function getHostInfo(host: string) {\n    let info = mHostInfoMap.get(host)\n    if (!info) {\n      info = new HostInfo()\n      mHostInfoMap.set(host, info)\n    }\n    return info\n  }\n\n  function getHostWeight(hostInfo: HostInfo, now: number) {\n    // TODO: ...\n    if (hostInfo.reqTimeAvg !== -1) {\n      const delayScore = 100 - hostInfo.reqTimeAvg * 0.2\n      return Math.max(delayScore, 10)\n    }\n    return 50\n  }\n\n  export function getUrlWeight(url: string, now: number, hostWeightMap: Map<string, number>) {\n    const urlInfo = mUrlInfoMap.get(url)\n    if (urlInfo && urlInfo.expire < now) {\n      if (urlInfo.status !== 200) {\n        return -2\n      }\n      // 该 URL 之前加载过\n      // expire 值越大，已过期的概率越小，权重越高\n      return 100 + urlInfo.expire\n    }\n\n    // 当前站点默认权重 -1，低于免费站点，减少流量成本\n    if (url[0] === '/') {\n      return hostWeightMap.get(MY_HOST) ?? -1\n    }\n    const host = getHostFromUrl(url)\n    const hostInfo = mHostInfoMap.get(host)\n    if (!hostInfo) {\n      return hostWeightMap.get(host) ?? 50\n    }\n    return getHostWeight(hostInfo, now)\n  }\n\n  export async function fetch(req: Request) {\n    const host = getHostFromUrl(req.url)\n    const hostInfo = getHostInfo(host)\n    hostInfo.pending++\n\n    const t0 = getTimeSec()\n\n    let res: Response\n    try {\n      res = await NATIVE_FETCH(req)\n    } catch (err: any) {\n      parseFetchError(err, req, hostInfo, t0)\n      throw err\n    } finally {\n      hostInfo.pending--\n    }\n\n    const maxAge = parseMaxAge(res.headers, t0)\n\n    switch (res.status) {\n    case 200:\n      if (req.cache !== 'no-store') {\n        if (maxAge > 60) {\n          addUrlInfo(res.url, 200, t0 + maxAge)\n        }\n      }\n      break\n    case 404:\n      addUrlInfo(res.url, 404, t0 + maxAge)\n      break\n    }\n\n    // 过期时间会在 expires 参数中会用到，避免重复分析\n    (res as any)._maxage = maxAge\n\n    return res\n  }\n\n  const REG_NET_ERR = /^Failed to fetch|^NetworkError|^Could not connect/\n\n  function parseFetchError(err: Error, req: Request, hostInfo: HostInfo, t0: number) {\n    if (!navigator.onLine) {\n      return\n    }\n    if (!REG_NET_ERR.test(err.message)) {\n      return\n    }\n    if (req.cache === 'only-if-cached') {\n      return\n    }\n    hostInfo.errNum++\n    hostInfo.lastErrTime = t0\n  }\n\n  function parseMaxAge(headers: Headers, t0: number) {\n    const cacheControl = headers.get('cache-control')\n    if (cacheControl !== null) {\n      if (cacheControl.includes('no-cache')) {\n        return 0\n      }\n      const m = cacheControl.match(/max-age=\"?(\\d+)\"?/)\n      if (m) {\n        return +m[1]\n      }\n    }\n    const expires = headers.get('expires')\n    if (expires !== null) {\n      const t1 = Date.parse(expires) / 1000\n      if (t1) {\n        return (t1 - t0) | 0\n      }\n    }\n    return Conf.DEFAULT_MAX_AGE\n  }\n\n\n  function parseEntries(list: PerformanceEntryList) {\n    const timeBase = performance.timeOrigin\n\n    for (const record of list as PerformanceResourceTiming[]) {\n      const host = getHostFromUrl(record.name)\n      const info = getHostInfo(host)\n\n      info.reqNum++\n      info.lastDoneTime = timeBase + record.responseEnd\n\n      // time-allow-origin\n      if (record.responseStart > 0) {\n        const reqTime = record.responseStart - record.requestStart\n        info.reqTimeSum += reqTime\n        info.reqTimeAvg = info.reqTimeSum / info.reqNum\n      }\n    }\n  }\n\n\n  export async function init() {\n    await mDatabase.open({\n      'cache': {\n        keyPath: 'url'\n      },\n    })\n\n    const now = getTimeSec()\n\n    // 读取 URL 历史信息\n    await mDatabase.enum('cache', (item: UrlInfo) => {\n      if (item.expire < now) {\n        mDatabase.delete('cache', item.url)\n        return\n      }\n      mUrlInfoMap.set(item.url, item)\n    })\n\n    // 跟踪每个 URL 的性能指标\n    const entries = performance.getEntriesByType('resource')\n    parseEntries(entries)\n\n    const observer = new PerformanceObserver(entryList => {\n      const entries = entryList.getEntries()\n      parseEntries(entries)\n    })\n    observer.observe({\n      entryTypes: ['resource']\n    })\n  }\n\n\n  export function parseWeightConf(manifest: Manifest) {\n    const zone = navigator.language.toLowerCase()\n    const zone0 = zone.split('-')[0]\n    const weightParams =\n      manifest.getParams('@weight ' + zone) ||\n      manifest.getParams('@weight ' + zone0) ||\n      manifest.getParams('@weight')\n\n    if (!weightParams) {\n      const obj = ZONE_HOST_SCORE[zone] || ZONE_HOST_SCORE['*']\n      return new Map(Object.entries(obj))\n    }\n\n    const map = new Map<string, number>()\n    for (const [k, v] of weightParams) {\n      const num = +v\n      if (isNaN(num)) {\n        continue\n      }\n      map.set(k, num)\n    }\n    return map\n  }\n}\n","const TEXT_ENCODER = new TextEncoder()\nconst TEXT_DECODER = new TextDecoder()\n\nfunction utf8ToBytes(str: string) : Uint8Array {\n  return TEXT_ENCODER.encode(str)\n}\n\nfunction bytesToUtf8(bytes: Uint8Array) : string {\n  return TEXT_DECODER.decode(bytes)\n}\n\nfunction bytesToAsc(bytes: Uint8Array) : string {\n  return bytes.reduce((s, v) => s + String.fromCharCode(v), '')\n}\n\nfunction base64Encode(bytes: Uint8Array) : string {\n  return btoa(bytesToAsc(bytes))\n}\n\nfunction base64Decode(str: string) : Uint8Array | undefined {\n  try {\n    str = atob(str)\n  } catch {\n    return\n  }\n  const bin = new Uint8Array(str.length)\n  for (let i = 0; i < bin.length; i++) {\n    bin[i] = str.charCodeAt(i)\n  }\n  return bin\n}\n\nfunction parseJson(str: string) {\n  try {\n    return JSON.parse(str)\n  } catch {\n  }\n}\n\nfunction splitList(str: string) : string[] {\n  str = str.trim()\n  if (!str) {\n    return []\n  }\n  return str.split(/\\s+/)\n}\n\nfunction parseStrOrB64(str: string) : Uint8Array | undefined {\n  // json string\n  if (str[0] === '\"') {\n    str = parseJson(str)\n    if (str === undefined) {\n      return\n    }\n    return utf8ToBytes(str)\n  }\n  // base64\n  return base64Decode(str)\n}\n\nconst TIME_UNIT: {[key: string] : number} = {\n  ''   : 1,\n  'ms' : 1,\n  's'  : 1000,\n  'min': 1000 * 60,\n  'h'  : 1000 * 3600,\n  'd'  : 1000 * 3600 * 24,\n  'y'  : 1000 * 3600 * 24 * 365,\n}\n\nfunction parseTime(str: string) : number {\n  const m = str.match(/^([\\d.]{1,9})(y|d|h|min|s|ms|)$/)\n  if (!m) {\n    return NaN\n  }\n  const [, num, unit] = m\n  return +num * TIME_UNIT[unit]\n}\n\nfunction parseByteUnit(str: string) : number {\n  const m = str.match(/^([\\d.]{1,9})(k|K|M|G|)(i|)(b|B|)$/)\n  if (!m) {\n    return NaN\n  }\n  const [, num, kMG, i, bB] = m\n  const exponent =\n    kMG === 'k' ? 1 :\n    kMG === 'K' ? 1 :\n    kMG === 'M' ? 2 :\n    kMG === 'G' ? 3 : 0\n\n  const base = i ? 1024 : 1000\n  const unit = bB === 'b' ? 8 : 1\n  return +num * base ** exponent / unit\n}\n\nfunction getTimeSec() : number {\n  return Date.now() / 1000 | 0\n}\n\nfunction concatBufs(bufs: Uint8Array[], size = 0) : Uint8Array {\n  if (size === 0) {\n    for (const v of bufs) {\n      size += v.length\n    }\n  }\n  const ret = new Uint8Array(size)\n  let pos = 0\n  for (const v of bufs) {\n    ret.set(v, pos)\n    pos += v.length\n  }\n  return ret\n}\n\n\nfunction isArrayEqual<T>(b1: ArrayLike<T>, b2: ArrayLike<T>) : boolean {\n  if (b1.length !== b2.length) {\n    return false\n  }\n  for (let i = 0; i < b1.length; i++) {\n    if (b1[i] !== b2[i]) {\n      return false\n    }\n  }\n  return true\n}\n\n\nfunction getPair(str: string, delim: string) : [string, string?] {\n  const pos = str.indexOf(delim)\n  if (pos === -1) {\n    return [str]\n  }\n  return [\n    str.substring(0, pos),\n    str.substring(pos + delim.length)\n  ]\n}\n\nfunction mergeMap<K, V>(dst: Map<K, V>, src: Iterable<[K, V]>) : void {\n  for (const [k, v] of src) {\n    dst.set(k, v)\n  }\n}\n\n/**\n * @param url absolute or relative url\n */\nfunction stripUrlQuery(url: string) : string {\n  const pos = url.indexOf('?')\n  if (pos === -1) {\n    return url\n  }\n  return url.substring(0, pos)\n}\n\n/**\n * @param url absolute url\n */\nfunction getHostFromUrl(url: string) : string {\n  const m = url.match(/^https?:\\/\\/([^/]+)/) as string[]\n  return m[1]\n}\n\n/**\n * @param url absolute or relative url\n */\nfunction toRelUrl(url: string) : string {\n  if (url.startsWith(ROOT_PATH)) {\n    return url.substring(MY_ORIGIN.length)\n  }\n  return url\n}\n\nasync function sha256(buf: Uint8Array) : Promise<Uint8Array> {\n  const ret = await CRYPTO.digest('SHA-256', buf)\n  return new Uint8Array(ret)\n}\n","const ZONE_HOST_SCORE: {\n  [zone: string]: {\n    [host: string]: number\n  }\n} = {\n  'zh-cn': {\n    'ajax.cdnjs.com': 50,\n    'cdnjs.cloudflare.com': 50,\n    'cdn.jsdelivr.net': 80,\n    'raw.githubusercontent.com': 10,\n    'cdnjs.loli.net': 70,\n    'lib.baomitu.com': 80,\n    'lf6-cdn-tos.bytecdntp.com': 90,\n    'cdn.staticfile.org': 90,\n    'cdn.bootcss.com': 10,\n    'cdn.bootcdn.net': 80,\n    'unpkg.com': 50,\n    'g.alicdn.com': 90,\n    'pagecdn.io': 20,\n    'ajax.aspnetcdn.com': 60,\n    'ajax.googleapis.com': 10,\n    'code.jquery.com': 20,\n    'stackpath.bootstrapcdn.com': 30,\n    'maxcdn.bootstrapcdn.com': 30,\n    'cdn.datatables.net': 40,\n    'twemoji.maxcdn.com': 40,\n  },\n  '*': {\n    'ajax.cdnjs.com': 90,\n    'cdnjs.cloudflare.com': 90,\n    'cdn.jsdelivr.net': 40,\n    'raw.githubusercontent.com': 10,\n    'cdnjs.loli.net': 40,\n    'lib.baomitu.com': 20,\n    'lf6-cdn-tos.bytecdntp.com': 40,\n    'cdn.staticfile.org': 20,\n    'cdn.bootcss.com': 10,\n    'cdn.bootcdn.net': 20,\n    'unpkg.com': 40,\n    'g.alicdn.com': 30,\n    'pagecdn.io': 40,\n    'ajax.aspnetcdn.com': 70,\n    'ajax.googleapis.com': 90,\n    'code.jquery.com': 50,\n    'stackpath.bootstrapcdn.com': 40,\n    'maxcdn.bootstrapcdn.com': 50,\n    'cdn.datatables.net': 50,\n    'twemoji.maxcdn.com': 50,\n  },\n}"]}